!function(){"use strict";angular.module("Notebook.Config",["Notebook.Constants"]).provider("NotebookConfig",["NBSortConstants",function(e){var t={domainPath:"",apiBasePath:"/api/v1/notebook",allNotesApiBasePath:"/notebook/api/v2",notificationTop:"50px",maxCharCount:1050,allowedCharCount:1e3,maxNotesPerPage:20,moreViewCharCount:300,maxPromptsPerPageForPagination:20,notificationDismissalTime:3e3,minSearchTermCount:3,maxSearchTermCount:100,notesPerScrollInitial:10,notesPerScroll:30,enableMultiSortPrompts:!1,defaultSortPromptsBy:e.sortPromptsBy.date};this.set=function(e,o){t[e]=o},this.$get=function(){return t}}])}(),function(){"use strict";angular.module("Notebook.Constants",[]).constant("BrowserConstants",{IPAD:"iPad",IE:"Internet Explorer",IE_EDGE:"Microsoft Edge",FIREFOX:"Firefox"}).constant("NBRegexConstants",{allCharsAsInvalidStart:"^[\\",allCharsAsInvalidEnd:"]*$",matchAllCharsFromStart:/^(.)/gi,matchAllCharsTillEnd:/(.)$/gi,empty:"",multiSpaces:/\s\s+/g,singleSpace:" ",nonBreakingSpace:/\&nbsp;/gi,singleQuotes:/\'/gi,spaceCharacters:/\s|\&nbsp;/g,matchCharDigits:/^[a-zA-Z0-9]*$/,boundaryChars:' |\\s|\\.|\\?|\\+|\\*|\\||{|}|\\[|\\]|\\(|\\)|"|#|@|&|<|>|~|\\^|\\$|=|`|-|!|:|,'}).constant("NBRegexBoundaryConstants",{addBoundaryStart:function(e){return"(?:^|"+e+")($1"},addBoundaryEnd:function(e){return"$1)(?=$|"+e+")"}}).constant("NBSearchInvalidCharacterConstants",{invalidChars:["&","^","*","@","$","=","`","<",">",",","+","-","|","!","(",")","{","}","[","]",'"',"~",":","\\"]}).constant("NBCustomErrorMessages",{requestCancelled:"REQUEST_CANCELLED"}).constant("NBSectionConstants",{searchSection:"search",tocSection:"toc",dateSection:"date"}).constant("NBZeroStateConstants",{zeroNotes:{messageKey:"notebook-zero-states.zeroNotes",defaultMessage:"There are no notes",className:"nb-no-notes-zero-state-container"},zeroPrompts:{messageKey:"notebook-zero-states.zeroPrompts",defaultMessage:"There are no prompts",className:"nb-no-prompts-zero-state-container"},zeroPromptsAndNotes:{messageKey:"notebook-zero-states.zeroPromptsNotes",defaultMessage:"There are no notes or prompts",className:"nb-no-notes-no-prompts-zero-state-container"},unansweredPrompts:{messageKey:"notebook-zero-states.unansweredPrompts",defaultMessage:"There is no response to this prompt",className:"nb-unanswered-prompt-container"},defaultState:{messageKey:"defaultState",defaultMessage:"No Zero states"}}).constant("NBComplexSeachTerms",{complexSearchTerm:["or","and","^","~"]}).constant("NBNotePromptIndicatorLabels",{promptLabel:"Notebook Promptpppp",noteLabel:"Notebook Note",promptLabelKey:"notebook-labels.promptIndicatorLabel",noteLabelKey:"notebook-labels.noteIndicatorLabel"}).constant("NBSortConstants",{sortPromptsBy:{questionOrder:"questionOrder",date:"date"}})}(),function(){"use strict";angular.module("Notebook.Events",[]).constant("NotebookEvents",{promptsUpdated:"notebook.prompts.updated",addNote:"notebook.add.note",showAllNotes:"notebook.allnotes.show",closeAllNotes:"notebook.allnotes.close",onUnitClicked:"notebook.allnotes.unit.clicked",save:"notebook.prompt.save",autoSave:"notebook.prompt.autosave",archive:"notebook.prompt.archive.on",unArchive:"notebook.prompt.archive.off",noteUpdated:"notebook.entry.updated",noteDeleted:"notebook.entry.deleted",noteSaved:"notebook.entry.saved",saveFailed:"notebook.save.failed",noteArchived:"notebook.entry.archived",noteUnArchived:"notebook.entry.unarchived",displaySavedAlert:"notebook.saved.alert.show",dismissSavedAlert:"notebook.saved.alert.dismiss",promptClicked:"notebook.prompt.clicked",promptEdited:"notebook.prompt.edit",noteAdded:"notebook.note.added",focusEditor:"notebook.editor.focus",newPromptAfterDelete:"notebook.allnotes.newprompt.after.delete",updateFilters:"notebook.allnotes.filters.update",displayTypeChanged:"notebook.allnotes.displayType.changed",displayTypeUpdated:"notebook.allnotes.displayType.updated",dataLoadCompleted:"notebook.allnotes.dataLoad.completed",currentPageChanged:"notebook.allnotes.currentPage.changed",currentPageChangeComplete:"notebook.allnotes.currentPage.change.completed",currentPageIsEmpty:"notebook.allnotes.currentPage.empty",filtersUpdated:"notebook.allnotes.filters.changed",onSearch:"notebook.allnotes.on.search",filtersUpdateComplete:"notebook.allnotes.filters.complete",onSearchError:"notebook.allnotes.on.search.error",initPagination:"notebook.allnotes.init.pagination",toggleFilterOptions:"notebook.allnotes.toggle.filters"}).constant("KeyboardEvents",{ENTER:13,SPACE:32,TAB:9})}(),function(){"use strict";angular.module("NotebookApp",["Notebook.uiconfig.service","Notebook.Events","Notebook.Config","Notebook.restApi","Notebook.textPrompt","Notebook.savedPrompt","Notebook.prompt","Notebook.notificationMessage","Notebook.listing","Notebook.panel","Notebook.filter.truncate","Notebook.service","Notebook.allNotesHeader","Notebook.allNotes","Notebook.allNotesUnitList","Notebook.messageOverlay","Notebook.headsupMessage.service","Notebook.focusElement","Notebook.allNotesDisplayOptions","Notebook.promptsFilter","Notebook.allNotesPaginatedList","Notebook.allNotesPaginationFooter","lst.localization.localizeFilter","Notebook.highlight.filter","Notebook.headsupMessage","Notebook.browserSpecific.service","Notebook.Constants","Notebook.search.service","Notebook.util.service","infinite-scroll","Notebook.zeroState"])}(),function(){"use strict";function e(e,t,o,n,r){return function(o){var a=r.getWordHits(),i=function(o,r){var a=t.createRegexForHighlight(r),i=o.replace(new RegExp(a,"gi"),function(e,o){var n="",r="";return e[0]!==o[0]&&(n=e[0]),e[e.length-1]!==o[o.length-1]&&(r=e[e.length-1]),n+t.addMarkTags(o)+r});try{return e(i),i}catch(s){return n.error("Error while applying Highlighting "+s),o}},s=function(e){var t=document.createElement("div");return t.innerHTML=e,t},l=function(e,t){for(var o=s(t);o.firstChild;)e.parentNode.insertBefore(o.firstChild,e);e.parentNode.removeChild(e)},c=function(e,t){var o;if(1===e.nodeType){if(e=e.firstChild)do o=e.nextSibling,c(e,t);while(e=o)}else if(3===e.nodeType){var n=i(e.nodeValue,t);l(e,n)}},p=s(o);return a.map(function(e){c(p,e)}),p.innerHTML}}angular.module("Notebook.highlight.filter",[]).filter("notebookHighlight",["$sanitize","NotebookUtilService","NBRegexConstants","NotebookLog","NotebookAllNotesService",e])}(),function(e){var t=/(\s*\S+|\s)$/;e.truncate=function(t,o){return e("<div></div>").append(t).truncate(o).html()},e.fn.truncate=function(o){e.isNumeric(o)&&(o={length:o});var n=e.extend({},e.truncate.defaults,o);return this.each(function(){var o=e(this);n.noBreaks&&o.find("br").replaceWith(" ");var r=o.text(),a=r.length-n.length;n.stripTags&&o.text(r),n.words&&a>0&&(a=r.length-r.slice(0,n.length).replace(t,"").length-1),a<0||!a&&!n.truncated||e.each(o.contents().get().reverse(),function(t,o){var r=e(o),i=r.text(),s=i.length;return s<=a?(n.truncated=!0,a-=s,void r.remove()):3===o.nodeType?(e(o.splitText(s-a)).replaceWith(n.ellipsis),!1):(r.truncate(e.extend(n,{length:s-a})),!1)})})},e.truncate.defaults={stripTags:!1,words:!1,noBreaks:!1,length:1/0,ellipsis:"…"}}($),function(){function e(){return function(e,t,o){if(!e||0===e.length)return e;var n=$.truncate(e,{length:t,ellipsis:o});return n}}angular.module("Notebook.filter.truncate",[]).filter("noteBookTruncate",[e])}(),function(){"use strict";var e=function(e,t,o,n){var r,a=o.createNoteApi(),i=o.saveNoteApi(),s=o.notesApi(),l=o.noteApi(),c=o.pagesApi(),p=o.booksApi(),u=o.archiveNoteApi(),d=o.allNotesApi(),g=o.snapshotsApi(),f=this;f.createBook=function(o,n){return e.post(p,{app:o,bookContext:n}).then(function(e){return e.data},function(e){return t.reject(e)})},f.createPage=function(o,n){var r=c.replace(":bookId",o);return e.post(r,{pageContext:n}).then(function(e){return e.data},function(e){return t.reject(e)})},f.getPages=function(o){var n=c.replace(":bookId",o);return e.get(n).then(function(e){return e.data},function(e){return t.reject(e)})};var m=function(e,t,o,n){return e=e.replace(":bookId",t).replace(":pageId",o),n&&(e=e.replace(":noteId",n)),e};f.getNotes=function(o,n){var r=m(s,o,n);return e.get(r).then(function(e){return e.data},function(e){return t.reject(e)})},f.createNote=function(o,n,r){var i=m(a,o,n);return e.post(i,r).then(function(e){return e.data},function(e){return t.reject(e)})},f.saveNote=function(o,n,r,a){var s=m(i,o,n,r);return e.post(s,a).then(function(e){return e.data},function(e){return t.reject(e)})},f.deleteNote=function(o,n,r){var a=m(l,o,n,r);return e["delete"](a).then(function(e){return e.data},function(e){return t.reject(e)})},f.archiveNote=function(o,n,r){var a=m(u,o,n,r);return e.put(a).then(function(e){return e.data},function(e){return t.reject(e)})},f.getAllNotes=function(o){var n=d.replace(":bookId",o);return e.get(n).then(function(e){return e.data},function(e){return t.reject(e)})},f.getNotesForPages=function(o,r){var a=d.replace(":bookId",o),i=t.defer(),s=e.post(a,{pageContexts:r},{timeout:i.promise}).then(function(e){if(e)return e.data;var o={message:n.requestCancelled,status:0};return t.reject(o)},function(e){return t.reject(e)});return s.abort=function(){i.resolve()},s},r=function(e,t,o){return e=e.replace(":bookId",t).replace("{snapshotid}",o)},f.createSnapshots=function(o,n,a){var i=r(g,o,a);return e.put(i,n).then(function(e){return e.data},function(e){return t.reject(e)})},f.getSnapshots=function(o,n){var a=r(g,o,n);return e.get(a).then(function(e){return e.data},function(e){return t.reject(e)})}};angular.module("Notebook.restApi.endPoints",[]).service("NotebookRestAPIEndpoints",["$http","$q","NotebookRestAPIs","NBCustomErrorMessages",e])}(),function(){"use strict";var e=function(e){var t=this,o=e.domainPath+e.apiBasePath,n={books:"/books",pages:"/books/:bookId/pages",notes:"/books/:bookId/pages/:pageId/notes",allNotes:"/books/:bookId/notes",note:"/books/:bookId/pages/:pageId/notes/:noteId",saveNote:"/books/:bookId/pages/:pageId/notes/:noteId/save",archiveNote:"/books/:bookId/pages/:pageId/notes/:noteId/archive",snapshots:"/books/:bookId/snapshots?id={snapshotid}"},r=function(e){return o+e};t.booksApi=function(){return r(n.books)},t.pagesApi=function(){return r(n.pages)},t.notesApi=function(){return r(n.notes)},t.noteApi=function(){return r(n.note)},t.createNoteApi=function(){return t.notesApi()},t.saveNoteApi=function(){return r(n.saveNote)},t.allNotesApi=function(){return e.domainPath+e.allNotesApiBasePath+n.allNotes},t.archiveNoteApi=function(){return r(n.archiveNote)},t.snapshotsApi=function(){return r(n.snapshots)}};angular.module("Notebook.restApis",[]).service("NotebookRestAPIs",["NotebookConfig",e])}(),function(){"use strict";angular.module("Notebook.restApi",["Notebook.restApis","Notebook.restApi.endPoints"])}(),function(){"use strict";var e=function(e,t,o,n,r,a,i,s,l,c,p){var u=[],d=this;this.currentBookId=null,this.currentPageId=null,this.bookContext=null,this.bookIndexId="",d.resetPrompts=function(){u=[]},d.getPagePrompts=function(){return u},d.hasPrompts=function(){return u.length>0},d.getNotesCount=function(){return i.getNotesCount(u)},d.setBookIndexId=function(e){d.bookIndexId=e},d.getBookIndexId=function(){if(d.bookIndexId)return d.bookIndexId;throw new Error("Must provide valid book index Id")};var g=function(){var e=i.getDefaultPrompt(d.currentPageId);u.unshift(e),t.$broadcast(o.noteAdded)},f=function(){var e=d.getPagePrompts().filter(function(e){return void 0===e.objectId&&"n"===e.contentType});return e.length>=1},m=function(e){var t=s.getPageContextIdMap();return t[e]},b=function(e){if(e.units)return e;if(e.pages){e.units=[];var t={title:"Notebook Generated Unit",unitId:"nbGenUnitId",pages:e.pages};return e.units.push(t),delete e.pages,e}return void l.error("TOC object not in supported format")};d.shouldDisableAddNote=function(){var e=d.getPagePrompts().filter(function(e){return"n"===e.contentType});return e.length>=n.maxNotesPerPage||f()},d.getZeroStateForUnansweredPrompts=function(){return c.showUnansweredPrompts()?p.unansweredPrompts:p.defaultState},d.createBook=function(t,o,n){return d.bookContext&&d.bookContext===o&&d.currentBookId?(l.log("Getting book from nb-service no api calls made"),e.when(d.currentBookId)):(s.resetPageContextIdMaps(),n&&d.setBookIndexId(n),r.createBook(t,o).then(function(e){return d.bookContext=o,d.currentBookId=e,e},function(t){return d.bookContext=null,d.currentBookId=null,e.reject(t)}))},d.createPage=function(t){var o=m(t);return o?(l.log("Getting page id from page context and id map"),d.currentPageId=o,e.when(o)):r.createPage(d.currentBookId,t).then(function(e){return d.currentPageId=e,s.updatedPageContextIdMaps(t,e),e},function(t){return d.currentPageId=null,e.reject(t)})},d.getNotes=function(t){return r.getNotes(d.currentBookId,d.currentPageId,t).then(function(e){return u=e,e},function(t){return u=null,e.reject(t)})},d.removePromptsInPagePrompts=function(){var e=d.getPagePrompts().filter(function(e){return"p"!==e.contentType});return u=e,e},d.resolveToc=function(e){return e=b(e),a.resolveToc(d.currentBookId,e,!0)},d.setAllNotesDefaultFilterTitles=function(e){a.setAllNotesDefaultFilterTitles(e)},t.$on(o.addNote,function(){g()});var v=function(e,t){return r.updateNote(d.currentBookId,e,t)};d.updateNote=function(t,o){if(t.bookIndexId=d.getBookIndexId(),t.pageId)return v(t,o);var n=t.pageUrl,r=m(n);return r?(t.pageId=r,v(t,o)):void d.createPage(n).then(function(e){return t.pageId=e,s.updatedPageContextIdMaps(n,e),v(t,o)},function(t){return e.reject(t)})},t.$on(o.autoSave,function(e,t){d.updateNote(t,o.autoSave)}),t.$on(o.save,function(e,t){d.updateNote(t,o.save)}),t.$on(o.archive,function(e,t){d.updateNote(t,o.archive)}),t.$on(o.unArchive,function(e,t){d.updateNote(t,o.unArchive)}),t.$on(o.newPromptAfterDelete,function(e,n){n.archived=!1,n.objectId=null,n.content="",n.saved=!1,t.$broadcast(o.noteUpdated,n)})};angular.module("Notebook.service",["Notebook.rest.service","Notebook.allNotes.service","Notebook.transform.service"]).service("NotebookService",["$q","$rootScope","NotebookEvents","NotebookConfig","NotebookRestService","NotebookAllNotesService","NotebookTransform","NotebookPageService","NotebookLog","NotebookUIConfigService","NBZeroStateConstants",e])}(),function(){"use strict";var e=function(e,t,o,n,r,a,i,s,l,c,p,u,d,g,f,m){var b,v,h,k,N,y,S,C,P,I,T,w,A,$,E,x,L,D,F,M,U,B,j,z,O=this,R="notebook-filters.unitAssignments",H="notebook-filters.notesFilter",q=[],Z={},K=[R,H],V={},W=[],_=!1,Q={},G=[];O.filters=[],O.activeFilters=[],O.sortPromptsBy=i.defaultSortPromptsBy,O.setDisplayType=function(e){S=e},O.getDisplayType=function(){return S},O.setWordHits=function(e){G=e},O.getWordHits=function(){return G},O.setSelectedUnitId=function(e){w=e.selectedTocId?e.selectedTocId:e.units[0].unitId},O.getSelectedUnitId=function(){return w},O.getAllNotesDataLoadComplete=function(){return x},O.setAllNotesDataLoadComplete=function(e){x=e},O.setSelectedUnit=function(e){W=[],angular.forEach(e.units,function(e){w===e.unitId?A=e:W.push(e)})},O.getNotesCount=function(e){return n.getNotesCount(e)},O.setAllNotesDefaultFilterTitles=function(e){V={unitAssignmentsFilterTitle:e.allNotes.unitAssignmentsFilterTitle,notesFilterTitle:e.allNotes.notesFilterTitle}},O.getAllNotesDefaultTitles=function(){return V},O.getZeroState=function(){var e=O.activeFilters.indexOf(H)!==-1,t=1===O.activeFilters.length&&O.activeFilters.indexOf(H)!==-1,o=O.activeFilters.indexOf(R)!==-1,n=0===O.activeFilters.length,r=0===Q.promptCount,a=0===Q.notesCount;return r&&a?f.zeroPromptsAndNotes:r&&(o||!n&&!t)?f.zeroPrompts:a&&e?f.zeroNotes:f.defaultState},F=function(){Q={promptCount:0,notesCount:0}},b=function(e,t){for(var o=0;o<t.length;o++)if(e.tags.indexOf(t[o])!==-1)return!0;return!1},v=function(e,t,o){var n,r=t.indexOf(H)!==-1,a=t.indexOf(R)!==-1;return n=0===t.length||r&&a?e.filter(function(e){return!e.archived&&(!o||e.content)}):e.filter(function(e){return!(e.archived||"n"!==e.contentType||!r||o&&!e.content)||!(e.archived||"p"!==e.contentType||!a&&!b(e,t)||o&&!e.content)})},O.getPromptsForUnit=function(e){return v(Z[e],O.activeFilters,!1)},h=function(){var e,t=[];if(S===d.searchSection)e=l.getSearchResults(),e=v(e,O.activeFilters,!1);else{for(var o in Z)Z.hasOwnProperty(o)&&t.push(Z[o]);e=[].concat.apply([],t),e=v(e,O.activeFilters,!g.showUnansweredPrompts()),e=B(e)}return e},B=function(e){var t,o,r;return o=n.filterByContentType(e,"p"),r=o.length&&o[0].promptSequence,t=r&&O.sortPromptsBy===m.sortPromptsBy.questionOrder?j(e):n.sortNotes(e)},j=function(e){return e.sort(function(e,t){var o=e.pageNumber-t.pageNumber;return o||z(e,t)})},z=function(e,t){return e.promptSequence&&t.promptSequence?e.promptSequence-t.promptSequence:!!t.promptSequence-!!e.promptSequence||n.notesComparator(e,t)},U=function(){Z={},l.clearSearchResults(),O.setDisplayType(""),F()},O.getPages=function(){for(var e=h(),t=[],o=Math.ceil(e.length/i.maxPromptsPerPageForPagination),n=0;n<o;++n)t=t.concat("page"+n);return t},O.getPromptsForPage=function(e){var t=h();return t.slice((e-1)*i.maxPromptsPerPageForPagination,e*i.maxPromptsPerPageForPagination)},O.applyFilters=function(e){O.activeFilters!==e&&(O.activeFilters=e||[],t.$broadcast(r.filtersUpdated))},M=function(e){var t=g.getDefaultActiveFilters(),o=[];return t&&angular.forEach(t,function(t){e.indexOf(t)!==-1&&o.push(t)}),o},C=function(e){return e&&e.notes?e.notes:[]},P=function(e,t){return e[t]},I=function(e){var t=[];return angular.forEach(e.pages,function(e){t.push(e.pageUrl)}),t},k=function(e,t,o){var r,a=!1,i=p.getPageContextIdMap();return r=t.map(function(t){var r=e[t.pageUrl],s=C(r),l=P(i,t.pageUrl),c=o[t.pageUrl];return s=n.transformPrompts(s,c,l,a,t.pageUrl),s.map(function(e){return e.breadCrumb=t.breadCrumb,e.pageUrl=t.pageUrl,"p"===e.contentType?Q.promptCount++:"n"===e.contentType&&Q.notesCount++,e})}),[].concat.apply([],r)},T=function(e,t,o){Z[o.unitId]=k(e,o.pages,t.prompts),q=t.units.map(function(e){return{unitId:e.unitId,title:e.title}})};var Y=function(o,n,a,i,s){return T(o.data,n,a),e(function(){t.$broadcast(r.displayTypeUpdated,a)},0),E(s,n),q};$=function(e,t,n){var r=I(A),i=g.useSnapshot(),s=function(o){return Y(o,t,A,n,e)},l=function(e){return o.reject(e)};if(i){var c=g.getSnapshotId();return a.getSnapshots(e,c).then(s,l)}return a.getNotesForPages(e,r).then(s,l)},E=function(n,i){return D=[],angular.forEach(W,function(e){var t=I(e);D.push(a.getNotesForPages(n,t))}),o.all(D).then(function(o){angular.forEach(W,function(e,t){T(o[t].data,i,e)}),e(function(){t.$broadcast(r.dataLoadCompleted,W),t.$broadcast(r.displayTypeUpdated)},0),O.setAllNotesDataLoadComplete(!0)},function(e){return o.reject(e)})},L=function(){angular.forEach(D,function(e){u.cancelPromise(e)})},O.resolveToc=function(e,t,n){return L(),U(),O.setAllNotesDataLoadComplete(!1),y=t,O.setSelectedUnitId(t),O.setSelectedUnit(t),O.activeFilters=[],n&&(angular.isDefined(t.filters)?O.filters=K.concat(t.filters):O.filters=K,O.activeFilters=M(O.filters)),N!==e?(N=e,l.setAllPrompts(t.prompts),p.setPageContextIdMaps(e,t).then(function(){return $(e,t)},function(e){return o.reject(e)})):$(e,t)},t.$on(r.displayTypeChanged,function(n,a,i){if(O.setDisplayType(a),G=[],a===d.searchSection){if(!i)return void t.$broadcast(r.displayTypeUpdated);_=!0,O.setAllNotesDataLoadComplete(!1),L(),s.query(N,i).then(function(e){return G=e[1],l.reloadSearchResponse(e[0])},function(e){return l.clearSearchResults(),t.$broadcast(r.displayTypeUpdated),t.$broadcast(r.onSearchError),o.reject(e)})}else{if(_)return _=!1,l.clearSearchResults(),$(N,y,a);(O.getAllNotesDataLoadComplete()||a===d.tocSection)&&(O.setAllNotesDataLoadComplete(!0),e(function(){t.$broadcast(r.dataLoadCompleted,y.units)},0),t.$broadcast(r.displayTypeUpdated))}})};angular.module("Notebook.allNotes.service",["Notebook.log.service","Notebook.page.service"]).service("NotebookAllNotesService",["$timeout","$rootScope","$q","NotebookTransform","NotebookEvents","NotebookRestAPIEndpoints","NotebookConfig","NotebookCIService","NotebookSearchService","NotebookLog","NotebookPageService","NotebookUtilService","NBSectionConstants","NotebookUIConfigService","NBZeroStateConstants","NBSortConstants",e])}(),function(){"use strict";var e=function(e,t,o,n,r,a){var i=this;i.scrollToContainerForIPAD=function(e,o){if(t.name===r.IPAD){var n=e.parents(".notebook-allnotes-prompt-container"),a=n.offset().top;window.scrollTo(0,a-o)}},i.setFocusNonWebKit=function(e){t.webkit||e[0].focus()},t.name===r.IE_EDGE&&$(window).on("mousewheel",function(){event.preventDefault();var e=event.wheelDelta,t=window.pageYOffset;window.scrollTo(0,t-e)}),i.handleIEEditorEvents=function(e,o){t.name!==r.IE||"drop"!==o.type&&"paste"!==o.type||a(function(){e.trigger("input")},0)},i.callEditorClickForIPAD=function(o,a){var i=angular.element(o).find(".rich-text-editor");i.bind("touchstart click",function(o){t.name===r.IPAD&&(o.stopPropagation(),e.$broadcast(n.focusEditor,a))})},i.setFocusForFirefox=function(){t.name===r.FIREFOX&&($("#notebook-all-notes-input-search").blur(),$("#notebook-all-notes-input-search").focus())}};angular.module("Notebook.browserSpecific.service",["jlareau.bowser"]).service("NotebookBrowserSpecificService",["$rootScope","bowser","KeyboardEvents","NotebookEvents","BrowserConstants","$timeout",e])}(),function(){"use strict";var e=function(e,t){var o=this,n=function(e,t){return{pathVariables:{bookId:e},queryParams:{query:encodeURIComponent(t),includeArchived:!1}}};o.query=function(o,r){var a=n(o,r);return t.query(a).then(function(e){return e},function(t){return e.reject(t)})}};angular.module("Notebook.CI.service",["CIApp"]).service("NotebookCIService",["$q","CIQueryService",e])}(),function(){"use strict";var e=function(){var e,t,o=this,n=!1,r=!1;o.shouldShowHeadsupMessage=function(){return n},o.setShowHeadsupMessage=function(e){n=e},o.getHeadsupMessage=function(){return e},o.setHeadsupMessage=function(t){e=t},o.shouldShowAllNotesHeadsupMessage=function(){return r},o.setShowAllNotesHeadsupMessage=function(e){r=e},o.getAllNotesHeadsupMessage=function(){return t},o.setAllNotesHeadsupMessage=function(e){t=e}};angular.module("Notebook.headsupMessage.service",[]).service("NotebookHeadsupMessageService",[e])}(),function(){"use strict";var e=function(e){var t=this,o="nbService";t.debug=function(t,o){e.debug(t+":"+o)},t.log=function(t){e.debug(o+":"+t)},t.warn=function(t){e.warn(o+":"+t)},t.error=function(t){e.error(o+":"+t)}};angular.module("Notebook.log.service",[]).service("NotebookLog",["$log",e])}(),function(){"use strict";var e=function(e,t,o){var n,r,a,i={},s={},l={},c=this;r=function(e){angular.forEach(e,function(e){angular.forEach(e.pages,function(e){l[e.pageUrl]=e.breadCrumb})})},c.getBreadCrumbs=function(){return l},n=function(t){return o.getPages(t).then(function(e){return e.data},function(t){return e.reject(t)})},a=function(e){angular.forEach(e,function(e){i[e.objectId]=e.pageContext,s[e.pageContext]=e.objectId})},c.updatedPageContextIdMaps=function(e,t){s[e]||(s[e]=t),i[t]||(i[t]=e)},c.getPageIdContext=function(){return i},c.getPageContextIdMap=function(){return s},c.resetPageContextIdMaps=function(){i={},s={},l={},t.log("Reseted page context and page id maps")},c.setPageContextIdMaps=function(o,i){return n(o).then(function(e){a(e),r(i.units)},function(o){return c.resetPageContextIdMaps(),t.error("Error while fetching Page ID -- Page Context map "+o.status),e.reject(o)})}};angular.module("Notebook.page.service",[]).service("NotebookPageService",["$q","NotebookLog","NotebookRestAPIEndpoints",e])}(),function(){"use strict";var e=function(e,t,o,n,r,a,i,s){var l,c="nbService",p=this;p.createBook=function(e,o){return a.log("Creating book with app:"+e+" bookContext:"+o),e&&o?n.createBook(e,o).then(function(e){return a.debug(c,"Book id:"+e.data),e.data},function(e){return a.error(c,"createBook :"+e),t.reject(e)}):t.reject("createBook:Invalid app or bookContext")},p.createPage=function(e,o){return a.log("Creating page with bookId:"+e+" pageContext:"+o),l=o,e&&o?n.createPage(e,o).then(function(e){return a.debug(c,"Page id:"+e.data),e.data},function(e){return a.error(c,"createPage :"+e),t.reject(e)}):t.reject("createPage:Invalid bookId or pageContext")},p.getNotes=function(e,o,i){return a.log("Get notes with pageId:"+o),o?n.getNotes(e,o).then(function(e){var t=!0;return r.transformPrompts(e.data,i,o,t,l)},function(e){return a.error(c,"getNotes :"+e),t.reject(e)}):t.reject("getNotes:Invalid pageId")};var u=function(e,o,r){if(a.log("createNote with pageId:"+o+" isAutoSave:"+r.autoSave),!o)return t.reject("createNote:Invalid pageId");if(!r.content||0===r.content.length)return t.reject("createNote:Content is empty");if("p"!==r.contentType&&"n"!==r.contentType)return t.reject("createNote:Invalid contentType");if("n"===r.contentType&&r.promptId)return t.reject("Note is sending a promptId, only prompt should send a promptId");var i=s.removeMarkTags(r.content),l={content:i,contentType:r.contentType,autoSave:r.autoSave,promptId:r.promptId,bookIndexId:r.bookIndexId};return n.createNote(e,o,l)},d=function(e,o,r){return a.log("deleteNote with noteId:"+r.objectId),r.objectId?n.deleteNote(e,o,r.objectId):t.reject("deleteNote:Invalid noteId")},g=function(e,o,r){if(a.log("saveNote with noteId:"+r.objectId+" isAutoSave:"+r.autoSave),!r.objectId)return t.reject("saveNote:Invalid noteId");if(!r.content||0===r.content.length)return t.reject("saveNote:Content is empty");var i=s.removeMarkTags(r.content),l={content:i,autoSave:r.autoSave};return n.saveNote(e,o,r.objectId,l)},f=function(t,n,r,a,i){var s="";if("create"===i||"update"===i?(n.objectId=r.objectId,n.updated=r.updated):"delete"===i&&(n.tempId=Date.now(),s=n.objectId,delete n.objectId),a===o.save)n.saved=!0,e.$broadcast(o.noteSaved,n),e.$broadcast(o.displaySavedAlert,n);else if(a===o.archive||a===o.unArchive){n.archived=a===o.archive;var l=n.archived?o.noteArchived:o.noteUnArchived;e.$broadcast(l,n)}else e.$broadcast(o.noteUpdated,n)},m=function(t,n){a.error(n),e.$broadcast(o.saveFailed,t)},b=function(e,o,r){return r.objectId?n.archiveNote(e,o,r.objectId):t.reject("archiveNote:Invalid noteId")};p.updateNote=function(e,n,r){if(!n.isSaveInProgress){var a=null,i=null,s=r===o.autoSave,l=r===o.save||s,c=r===o.archive||r===o.unArchive;return!n.objectId&&l?(a="create",n.promptId="p"===n.contentType?n.promptId:"",n.autoSave=s===!0,i=u(e,n.pageId,n)):!l||!n.objectId||n.content&&0!==n.content.length?c?(a="archive",i=b(e,n.pageId,n)):(a="update",n.autoSave=s===!0,i=g(e,n.pageId,n)):(a="delete",i=d(e,n.pageId,n)),n.isSaveInProgress=!0,n.showSaveMessage=!c&&r!==o.save,i.then(function(t){return f(e,n,t.data,r,a),t},function(e){return m(n,e),t.reject(e)})}}};angular.module("Notebook.rest.service",["Notebook.transform.service","Notebook.log.service","Notebook.CI.service"]).service("NotebookRestService",["$rootScope","$q","NotebookEvents","NotebookRestAPIEndpoints","NotebookTransform","NotebookLog","NotebookCIService","NotebookUtilService",e])}(),function(){"use strict";var e=function(e,t,o,n,r,a,i){var s=this,l=[],c={},p=function(e){return!o.matchCharDigits.test(e)},u=function(e){return c[e].htmlTitle||c[e].title};s.setAllPrompts=function(e){angular.forEach(Object.keys(e),function(t){angular.forEach(e[t],function(e){c[e.promptId]=e})})},s.isValidSearchTerm=function(e){var t=n.invalidChars.join("\\"),r=new RegExp(o.allCharsAsInvalidStart+t+o.allCharsAsInvalidEnd);return!r.test(e)};var d=function(e){for(var t=i.complexSearchTerm,o=0;o<t.length;++o)if(e.toLowerCase().indexOf(t[o])>-1)return!0;return!1};s.getWildCardSearchTerm=function(e){var t=r.cleanSearchText(e);if(t.startsWith('"')&&t.endsWith('"'))return t;if(d(t))return t;for(var n="",a=t.split(o.spaceCharacters),i=0;i<a.length;i++)if(s.isValidSearchTerm(a[i]))if(p(a[i]))n=n+a[i]+o.singleSpace;else{var l=a[i].indexOf("*",a[i].length-1)===-1?a[i]+"*":a[i];n=n+l+o.singleSpace}return n.trim()},s.getSearchResults=function(){return l},s.getSearchResultsCount=function(){return l.length},s.clearSearchResults=function(){l=[],e.$broadcast(t.displayTypeUpdated)},s.reloadSearchResponse=function(o){var n=a.getPageIdContext(),r=a.getBreadCrumbs();l=o.map(function(e){var t={bookId:e.bookId,content:e.content,objectId:e.contentId,contentType:e.contentType,archived:e.isArchived,pageId:e.pageId,tags:e.activityTags,updated:e.updated,saved:e.isSaved,userId:e.userId,pageUrl:n[e.pageId],promptId:"p"===e.contentType?e.promptQuestionId:"",title:"p"===e.contentType?e.promptText:"",htmlTitle:"p"===e.contentType?u(e.promptQuestionId):""};return t.breadCrumb=r[t.pageUrl],t}),e.$broadcast(t.displayTypeUpdated)}};angular.module("Notebook.search.service",[]).service("NotebookSearchService",["$rootScope","NotebookEvents","NBRegexConstants","NBSearchInvalidCharacterConstants","NotebookUtilService","NotebookPageService","NBComplexSeachTerms",e])}(),function(){"use strict";var e=function(e){var t=this;t.getNotesCount=function(e){for(var t=0,o=0;o<e.length;++o){var n=e[o];void 0===n.objectId||null===n.objectId||n.archived||++t}return t},t.getDefaultPrompt=function(e){return{tempId:Date.now(),content:"",contentType:"n",pageId:e}};var o=function(e,t){return{content:"",promptId:e,pageId:t,contentType:"p"}},n=function(e){return"p"===e.contentType};t.filterByContentType=function(e,t){return e&&e.length?e.filter(function(e){return e.contentType===t}):e},t.sortNotes=function(e){return e&&e.length?e.sort(t.notesComparator):e},t.notesComparator=function(e,t){var o,n;return o=e.updated||0,n=t.updated||0,n-o},t.removeArchived=function(e){return e&&e.length?e.filter(function(e){return e.archived===!1}):e};var r=function(e,t){for(var o=0;o<e.length;++o)if(n(e[o])&&e[o].parentId===t)return e[o];return null};t.transformPrompts=function(n,i,s,l,c){n.forEach(function(e){e.updated=new Date(e.updated),e.pageId=s});var p,u=t.filterByContentType(n,"p"),d=t.filterByContentType(n,"n"),g=[];return i&&(g=i.map(function(e){var t=r(u,e.promptId);return t||(t=o(e.promptId,s)),t.title=e.title,t.htmlTitle=e.htmlTitle||e.title,t.promptId=e.promptId,t.tags=e.tags,t.pageNumber=e.pageNumber||0,t.promptSequence=e.promptSequence,delete t.parentId,t})),d=t.sortNotes(d),l!==!0||0!==d.length||0!==g.length&&!e.getShowOnlyNotesInSidePanel()||d.push(t.getDefaultPrompt(s)),g&&g.length&&a(d,g[0].pageNumber),p=[].concat(d).concat(g),p.forEach(function(t){t.isNotEditable=e.isPromptLocked(c)}),p};var a=function(e,t){e.forEach(function(e){e.pageNumber=t})}};angular.module("Notebook.transform.service",[]).service("NotebookTransform",["NotebookUIConfigService",e])}(),function(){"use strict";var e=function(e){var t,o=!0,n=!0,r=!0,a=!0,i=[],s=!1,l=!1,c=[],p=null,u=!0,d=this;d.setEditEnabled=function(e){o=e},d.showAllNotesHeader=function(){return n},d.setShowAllNotesHeader=function(e){n=e},d.showAllNotesDisplayOptions=function(){return r},d.setShowAllNotesDisplayOptions=function(e){r=e},d.showAllNotesFilters=function(){return a},d.setShowAllNotesFilters=function(e){a=e},d.setLockedPages=function(e){i=e},d.isPromptLocked=function(e){return!o||i.indexOf(e)!==-1},d.setShowUnansweredPrompts=function(e){s=e},d.showUnansweredPrompts=function(){return s},d.setShowZeroStateMessages=function(e){l=e},d.showZeroStateMessages=function(){return l},d.setDefaultActiveFilters=function(t){t instanceof Array?c=t:e.error("Default filter list provided should be an array")},d.getDefaultActiveFilters=function(){return c},d.setSnapshotId=function(e){p=e},d.getSnapshotId=function(){if(p)return p;throw new Error("Must provide valid snapshot id")},d.useSnapshot=function(){return t},d.setUseSnapshot=function(e){t=e},d.getShowOnlyNotesInSidePanel=function(){return u},d.setShowOnlyNotesInSidePanel=function(e){u=e}};angular.module("Notebook.uiconfig.service",[]).service("NotebookUIConfigService",["NotebookLog",e])}(),function(){"use strict";var e=function(e,t){var o=this;"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.substring(0,e.length)===e}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return this.substring(this.length-e.length,this.length)===e}),o.cancelPromise=function(e){e&&e.abort();
},o.removeMarkTags=function(e){return e.replace(/<b class="notebook-highlight">(.*?)<\/b>/g,"$1")},o.addMarkTags=function(e){return'<b class="notebook-highlight">'+e+"</b>"},o.cleanSearchText=function(t){return t.replace(e.singleQuotes,e.empty).replace(e.multiSpaces,e.singleSpace).replace(e.nonBreakingSpace,e.singleSpace).trim()},o.createRegexForHighlight=function(o){return o.replace(e.matchAllCharsFromStart,t.addBoundaryStart(e.boundaryChars)).replace(e.matchAllCharsTillEnd,t.addBoundaryEnd(e.boundaryChars))},o.highlightClassExists=function(e){return/notebook-highlight/.test(e)}};angular.module("Notebook.util.service",[]).service("NotebookUtilService",["NBRegexConstants","NBRegexBoundaryConstants",e])}(),function(){"use strict";function e(e,t,o,n,r,a,i,s,l,c,p){return{templateUrl:"views/allNotes/allNotes.dir.html",restrict:"E",scope:{toc:"=",selectedTocId:"=",showLoader:"=",containerId:"=",displayType:"@?"},link:function(n){n.showAllNotesHeadsupMsg=r.shouldShowAllNotesHeadsupMessage(),n.displayType=n.displayType?n.displayType:"toc",n.searchCount=0,n.searchTerm={inputDisplayValue:"",resultDisplayValue:""},n.errors={invalidSearch:!1,lessCharacter:!1},n.showAllNotesHeader=c.showAllNotesHeader();var i,s=n.displayType;n.$on(o.dataLoadCompleted,function(e,t){angular.forEach(t,function(e){angular.element("#unit-"+e.unitId).triggerHandler("click")}),n.displayType===l.dateSection&&(n.showLoader=!1)}),n.$on(o.updateFilters,function(e,o){t.applyFilters(o)}),n.$on(o.onSearchError,function(){n.showSearchErrorMessageInvalidCharacters=!0}),n.$on(o.displayTypeChanged,function(e,t,o){n.displayType=t,s=o,n.showLoader=!0,t!==l.searchSection&&n.searchTerm.inputDisplayValue&&(n.searchTerm={inputDisplayValue:"",resultDisplayValue:""})});var u=function(){c.showZeroStateMessages()&&(t.getZeroState()!==p.defaultState?(n.showZeroState=!0,n.zeroState=t.getZeroState(),n.zeroState===p.zeroPromptsAndNotes&&n.$broadcast(o.disableFilterOptions)):n.showZeroState=!1)};n.$on(o.currentPageChangeComplete,function(e,t){1!==t?n.showZeroState=!1:u()}),n.$on(o.displayTypeUpdated,function(){u(),n.displayType===l.searchSection&&(n.showLoader=!1,n.searchCount=a.getSearchResultsCount()),s===l.searchSection&&n.displayType!==l.tocSection||(n.showLoader=!1)}),n.$on(o.filtersUpdated,function(){u()}),n.$on("$destroy",function(){i&&e.cancel(i)})}}}angular.module("Notebook.allNotes",[]).directive("notebookAllNotes",["$timeout","NotebookAllNotesService","NotebookEvents","KeyboardEvents","NotebookHeadsupMessageService","NotebookSearchService","NotebookConfig","NotebookBrowserSpecificService","NBSectionConstants","NotebookUIConfigService","NBZeroStateConstants",e])}(),function(){"use strict";function e(e,t){return{templateUrl:"views/allNotesDisplayOptions/allNotesDisplayOptions.dir.html",restrict:"E",link:function(o){o.showFilterToggle=t.showAllNotesFilters();var n=function(t,n){o.$emit(e.displayTypeChanged,t,n)};o.changeDisplayType=function(e,t){e&&(e.preventDefault(),e.stopPropagation());var r=o.displayType;o.displayType=t,n(o.displayType,r)},o.toggleFilterOptions=function(){o.$emit(e.toggleFilterOptions)}}}}angular.module("Notebook.allNotesDisplayOptions",[]).directive("notebookAllNotesDisplayOptions",["NotebookEvents","NotebookUIConfigService",e])}(),function(){"use strict";function e(e,t,o,n,r,a,i){return{templateUrl:"views/allNotesHeader/allNotesHeader.dir.html",restrict:"E",scope:{searchTerm:"=",errors:"="},link:function(s){var l;l=function(){n.clearSearchResults(),e.setDisplayType("search")},s.onCloseAllNotes=function(){s.$emit(t.closeAllNotes),e.setWordHits([])},s.onCloseAllNotesKB=function(e){e.keyCode===o.ENTER&&s.onCloseAllNotes()},s.searchFocus=function(){angular.element(".notebook-all-notes-input-search").focus(),a.setFocusForFirefox()},s.clearSearchTerm=function(){s.searchTerm.inputDisplayValue="",s.searchFocus()},s.searchTermEnteredKB=function(e){if(e.keyCode===o.SPACE&&0===e.target.selectionStart&&e.preventDefault(),e.keyCode===o.ENTER){l(),s.displayType="search",s.errors.invalidSearch=!1,s.errors.lessCharacter=!0,s.searchTerm.resultDisplayValue=s.searchTerm.inputDisplayValue;var a=s.searchTerm.inputDisplayValue.split(i.spaceCharacters);if(a.forEach(function(e){e.length>=r.minSearchTermCount&&(s.errors.lessCharacter=!1)}),s.errors.lessCharacter)return l(),void s.$emit(t.displayTypeChanged,s.displayType);n.isValidSearchTerm(s.searchTerm.inputDisplayValue)?(s.searchTerm.resultDisplayValue=n.getWildCardSearchTerm(s.searchTerm.inputDisplayValue),s.$emit(t.displayTypeChanged,s.displayType,s.searchTerm.resultDisplayValue)):(s.errors.invalidSearch=!0,s.$emit(t.displayTypeChanged,s.displayType))}}}}}angular.module("Notebook.allNotesHeader",[]).directive("notebookAllNotesHeader",["NotebookAllNotesService","NotebookEvents","KeyboardEvents","NotebookSearchService","NotebookConfig","NotebookBrowserSpecificService","NBRegexConstants",e])}(),function(){"use strict";function e(e,t){return{templateUrl:"views/allNotesPaginatedList/allNotesPaginatedList.dir.html",restrict:"E",scope:{displayType:"@",searchTerm:"@",containerId:"@",showFilterMessage:"@"},link:function(o){var n,r;n=function(e){var n=1;e&&(n=e),o.pagePrompts=t.getPromptsForPage(n)},o.getErrorLabel=function(){return t.filters.length>0?{code:"notebook-error.allNotesNoDataForFilter",defaultLabel:"No data for selected filter."}:{code:"notebook-error.allNotesNoDataAvailable",defaultLabel:"No data available."}},r=function(){n(),o.$emit(e.initPagination)},r(),o.$on(e.currentPageChanged,function(t,r){if(o.containerId&&angular.element("#"+o.containerId).length){var a=angular.element("#"+o.containerId);a.animate({scrollTop:0},"fast")}else $(window).scrollTop(0);n(r),0===o.pagePrompts.length?o.$broadcast(e.currentPageIsEmpty,r-1):o.$emit(e.currentPageChangeComplete,r)}),o.$on(e.filtersUpdated,function(){r()}),o.$on(e.displayTypeUpdated,function(e,t){t||r()})}}}angular.module("Notebook.allNotesPaginatedList",[]).directive("notebookAllNotesPaginatedList",["NotebookEvents","NotebookAllNotesService",e])}(),function(){"use strict";function e(e,t,o){return{templateUrl:"views/allNotesPaginationFooter/allNotesPaginationFooter.dir.html",restrict:"E",link:function(n,r){r.limit||(r.limit=2);var a,i;n.paginationBarLimit=5,a=function(){n.pages=t.getPages(),n.pagination.last=n.pages.length},n.setCurrentPageKB=function(e,t){e&&e.keyCode===o.ENTER&&(e.preventDefault(),e.stopPropagation(),n.setCurrentPage(t))},n.setCurrentPage=function(t){n.pagination.current!==t&&(n.pagination.current=t,a(),n.$broadcast(e.currentPageChanged,t))},n.canShowPageNumber=function(e){var t=r.limit,o=r.limit;return n.pagination.current-2<1&&(t=3-(n.pagination.current-2)),n.pagination.current+2>n.pagination.last&&(o=3+(n.pagination.current-n.pagination.last+1)),!(e<n.pagination.current-o||e>n.pagination.current+t)},i=function(){n.pages=t.getPages(),n.pagination={current:1,last:n.pages.length}},n.$on(e.initPagination,function(){i()}),n.$on(e.currentPageIsEmpty,function(e,t){n.setCurrentPage(t)})}}}angular.module("Notebook.allNotesPaginationFooter",[]).directive("notebookAllNotesPaginationFooter",["NotebookEvents","NotebookAllNotesService","KeyboardEvents",e])}(),function(){"use strict";function e(){return{link:function(e,t,o){e.$eval(o.focusMe)&&t[0].focus()}}}angular.module("Notebook.focusElement",[]).directive("focusMe",[e])}(),function(){"use strict";function e(e,t){return{restrict:"E",link:function(o,n,r){var a;"false"===r.isAllNotes?a=t.getHeadsupMessage():"true"===r.isAllNotes&&(a=t.getAllNotesHeadsupMessage());var i=e(a)(o);n.append(i)}}}angular.module("Notebook.headsupMessage",[]).directive("notebookHeadsupMessage",["$compile","NotebookHeadsupMessageService",e])}(),function(){"use strict";function e(e,t,o,n,r,a,i,s){return{restrict:"EA",scope:{prompts:"=?",displayType:"@",searchTerm:"@",containerId:"@"},templateUrl:function(e,t){return"all-notes"===t.container?"views/listing/allNotesList.html":"views/listing/list.html"},link:function(l,c,p){l.enableMoreLess="all-notes"!==p.container,l.showHeadsupMsg=n.shouldShowHeadsupMessage(),l.scrolledCount=a.notesPerScrollInitial,l.scrollDisable=!1,l.zeroState=o.getZeroStateForUnansweredPrompts();var u=[],d=function(e){return e.promptId||e.objectId||e.tempId};l.scrollToNextPage=function(){l.prompts.length<=l.scrolledCount?l.scrollDisable=!0:l.scrolledCount+=a.notesPerScroll},l.getInfiniteScrollContainer=function(){return l.containerId&&angular.element("#"+l.containerId).length?"#"+l.containerId:""},l.isDisplayTOC=function(){return l.displayType===s.tocSection},l.$on(t.filtersUpdateComplete,function(){l.scrollDisable=!1,l.scrolledCount=a.notesPerScrollInitial}),l.setSelectedPrompt=function(t,o){if(l.selectedPrompt=t,o===!0){var n=e(function(){var e,o=d(t);"list"===p.container?e=c.find("#notebook-list-container"):"all-notes"===p.container&&(e=$("#all-notes-container"));var n=e.offset().top,a=c.find("#prompt-"+o),i=a.find(".rte-editbox"),s=i.offset().top+i.height()+55,l=i.offset().top-36,u=e.height(),g=e.scrollTop();s>u+n&&e.animate({scrollTop:s-n+g-u},"fast"),"all-notes"===p.container&&(r.scrollToContainerForIPAD(a,n),l<n&&l<0?e.animate({scrollTop:g-n+l},"slow"):l>=0&&l<=n&&e.animate({scrollTop:g-2*n+l},"fast"))},30);u.push(n)}},l.$on(t.promptsUpdated,function(){l.prompts=o.getPagePrompts()}),l.$on(t.noteAdded,function(){$(".notebook-list-container").animate({scrollTop:0},"fast"),l.setSelectedPrompt(l.prompts[0])}),l.$on(t.newPromptAfterDelete,function(e,t){l.setSelectedPrompt(t)});var g=function(t){if(t&&(void 0===t.saved||t.saved===!1)&&!t.isNotEditable){var o=d(t),n=c.find("#prompt-"+o),a=n.find(".rte-editbox");l.displayType===s.searchSection&&(t.content=i.removeMarkTags(t.content)),r.setFocusNonWebKit(a);var p=e(function(){if("undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var e=document.createRange();e.selectNodeContents(a[0]),e.collapse(!1);var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}else if("undefined"!=typeof document.body.createTextRange){var o=document.body.createTextRange();o.moveToElementText(a[0]),o.collapse(!1),o.select()}},10);u.push(p),a.scrollTop(a[0].scrollHeight)}};l.$on(t.promptClicked,function(t,o){if(void 0!==l.prompts){var n=l.prompts.filter(function(e){return e.promptId===o});l.setSelectedPrompt(n[0],!1);var r=e(function(){var e=c.find("#notebook-list-container"),t=e.offset().top,n=c.find("#title-"+o);if(l.selectedPrompt.saved){var r=c.find("#prompt-"+l.selectedPrompt.objectId),a=r.find(".notebook-saved-prompt-container");a.focus()}var i=n.offset().top,s=n.height(),p=e.scrollTop(),u=0;u=i-t>=0?i-t+p+s:p+s-(t-i),u>=0&&$(".notebook-list-container").animate({scrollTop:u},"fast")},100);u.push(r),g(n[0])}}),l.$on(t.promptEdited,function(t,o){l.setSelectedPrompt(o,!0);var n=e(function(){g(o)},20);u.push(n)}),l.$on(t.focusEditor,function(e,t){l.selectedPrompt!==t&&(l.setSelectedPrompt(t,!0),g(t)),"search"===l.displayType&&(t.content=i.removeMarkTags(t.content))}),l.$on(t.filtersUpdated,function(){l.selectedPrompt=null}),l.$on(t.currentPageChanged,function(){l.selectedPrompt=null}),l.$on("$destroy",function(){u.forEach(function(t){e.cancel(t)})})}}}angular.module("Notebook.listing",[]).directive("notebookList",["$timeout","NotebookEvents","NotebookService","NotebookHeadsupMessageService","NotebookBrowserSpecificService","NotebookConfig","NotebookUtilService","NBSectionConstants",e])}(),function(){"use strict";function e(e,t,o){return{restrict:"EA",templateUrl:"views/messageOverlay/messageOverlay.dir.html",link:function(n){var r;n.showNotification=!1,n.positionTop=e.notificationTop,n.$on(o.displaySavedAlert,function(){n.showNotification=!0,r=t(function(){n.showNotification=!1},e.notificationDismissalTime)}),n.$on(o.dismissSavedAlert,function(){n.showNotification=!1}),n.$on("$destroy",function(){r&&t.cancel(r)})}}}angular.module("Notebook.messageOverlay",[]).directive("notebookMessageOverlay",["NotebookConfig","$timeout","NotebookEvents",e])}(),function(){"use strict";function e(){return{templateUrl:"views/notebookZeroState/notebookZeroState.dir.html",restrict:"E",scope:{nbZeroState:"="}}}angular.module("Notebook.zeroState",[]).directive("notebookZeroState",[e])}(),function(){"use strict";function e(e,t,o){return{restrict:"EA",templateUrl:"views/notificationMessage/notificationMessage.dir.html",link:function(n){var r;n.prompt.showNotification=!1,n.$on(o.displaySavedAlert,function(o,a){a.objectId===n.prompt.objectId&&(n.prompt.showNotification=!0,r=t(function(){n.prompt.showNotification=!1},e.notificationDismissalTime))}),n.$on(o.dismissSavedAlert,function(){n.prompt.showNotification=!1}),n.$on("$destroy",function(){r&&t.cancel(r)})}}}angular.module("Notebook.notificationMessage",[]).directive("notebookNotificationMessage",["NotebookConfig","$timeout","NotebookEvents",e])}(),function(){"use strict";function e(e,t,o){return{templateUrl:"views/panel/panel.dir.html",restrict:"EA",scope:{nbmenuChapterTitle:"=nbmenuChapterTitle"},link:function(n){n.notesCount=0;var r=function(){n.notesCount=t.getNotesCount()};n.onAllNotes=function(){n.$emit(e.showAllNotes)},n.onAddNote=function(){n.$emit(e.addNote)},n.isAddNoteDisabled=function(){return t.shouldDisableAddNote()},n.getNotesLabel=function(){return n.notesCount>1?{code:"notebook-labels.notesLabel",defaultLabel:"Notes"}:{code:"notebook-labels.noteLabel",defaultLabel:"Note"}},n.$on(e.promptsUpdated,function(){o.getShowOnlyNotesInSidePanel()&&t.removePromptsInPagePrompts(),r()}),n.$on(e.noteUpdated,function(){r()}),n.$on(e.noteSaved,function(){r()})}}}angular.module("Notebook.panel",[]).directive("notebookPanel",["NotebookEvents","NotebookService","NotebookUIConfigService",e])}(),function(){"use strict";function e(e,t,o,n,r,a,i,s){return{restrict:"E",scope:{prompt:"=nbPrompt",isSelected:"=isSelected",enableMoreLess:"=enableMoreLess",displayType:"@",searchTerm:"@",zeroState:"=?"},templateUrl:function(e,t){return t.templateUrl||"views/prompt/prompt.html"},link:function(l){var c;l.prompt.isSaveInProgress=!1,l.prompt.showNotification=!1,l.prompt.showSaveMessage=!1,l.unArchive=!1,l.focusDelete=!1,"p"===l.prompt.contentType?l.prompt.contentLabel=o(s.promptLabelKey,[],s.promptLabel):l.prompt.contentLabel=o(s.noteLabelKey,[],s.noteLabel),l.searchTerm&&(l.prompt.content=t(l.prompt.content),l.prompt.htmlTitle&&(l.prompt.htmlTitle=t(l.prompt.htmlTitle))),l.onSave=function(e){l.$emit(n.save,e),l.$broadcast(n.save,e),l.selectedPromptId=e.objectId},l.isDoneDisabled=function(e){var t=angular.isUndefined(e.content)||0===e.content.length||e.remainingCount<0;return t},l.editPrompt=function(e){e.saved=!1,l.prompt.showSaveMessage=!1,l.searchTerm&&(e.content=a.removeMarkTags(e.content)),l.$emit(n.promptEdited,e)},l.enterEditPrompt=function(e,t){e.keyCode===r.ENTER&&(l.editPrompt(t),e.preventDefault())},l.editorClick=function(e){l.$emit(n.focusEditor,e)},l.enterEditorClick=function(e,t){e.keyCode===r.ENTER?(l.editorClick(t),e.preventDefault()):e.keyCode===r.TAB&&"rte-editbox"===e.target.className&&l.editorClick(t)},l.onDelete=function(e){l.$emit(n.archive,e),l.selectedPromptId=e.objectId,l.focusDelete=!0},l.onUndo=function(e,t){l.$emit(n.unArchive,t),l.unArchive=!0,e&&(e.preventDefault(),e.stopPropagation())},l.newPromptAfterDelete=function(e,t){l.$emit(n.newPromptAfterDelete,t),e&&(e.preventDefault(),e.stopPropagation())},l.onUnitClicked=function(e){l.$emit(n.onUnitClicked,e)},l.showDeleteButton=function(){return!l.prompt.archived&&""!==l.prompt.content&&l.prompt.objectId};var p=function(){l.prompt.showSaveMessage=!1};l.getSaveLabel=function(){return l.prompt.isSaveInProgress?{code:"notebook-labels.savingLabel",defaultLabel:"Saving..."}:{code:"notebook-labels.savedLabel",defaultLabel:"Saved"}};var u=function(t,o){l.prompt.isSaveInProgress&&o.objectId===l.prompt.objectId&&(l.prompt.isSaveInProgress=!1,l.prompt.showSaveMessage=n.noteUpdated===t.name,l.prompt.showSaveMessage&&(c=e(p,2e3)))};l.isNoteDeleted=function(){return"n"===l.prompt.contentType&&l.prompt.archived},l.isPromptUnArchieved=function(){return"p"===l.prompt.contentType||!l.prompt.archived},l.isTextPrompt=function(){return!l.prompt.isNotEditable&&!l.prompt.archived&&!l.prompt.saved},l.isSavedPrompt=function(){return!l.prompt.isNotEditable&&!l.prompt.archived&&l.prompt.saved},l.isDeletedPrompt=function(){return!l.prompt.isNotEditable&&l.prompt.archived&&"p"===l.prompt.contentType},l.isUnEditablePrompt=function(){return l.prompt.isNotEditable},l.showZeroStateMsg=function(){return!l.prompt.content&&l.zeroState!==i.defaultState},l.$on(n.saveFailed,function(e,t){u(e,t)}),l.$on(n.noteArchived,function(e,t){u(e,t)}),l.$on(n.noteUnArchived,function(e,t){u(e,t)}),l.$on(n.noteUpdated,function(e,t){u(e,t)}),l.$on(n.noteSaved,function(e,t){u(e,t)}),l.$on("$destroy",function(){c&&(e.cancel(c),p())})}}}angular.module("Notebook.prompt",[]).directive("notebookPrompt",["$timeout","notebookHighlightFilter","localizeFilter","NotebookEvents","KeyboardEvents","NotebookUtilService","NBZeroStateConstants","NBNotePromptIndicatorLabels",e])}(),function(){"use strict";function e(e,t,o,n,r){return{templateUrl:"views/promptsFilter/promptsFilter.dir.html",restrict:"E",link:function(a){var i=t.getAllNotesDefaultTitles();a.displayFilterType="toc",a.displayFilterOptions=!0,a.enableZeroPromptsAndNotesState=!0,a.filterOptions=[],a.showAllNotesDisplayTypeOptions=r.showAllNotesDisplayOptions(),a.showAllNotesFilterOptions=r.showAllNotesFilters();for(var s=function(e,t,o){return e?e:n(t,[],o)},l=0;l<t.filters.length;l++){var c=t.filters[l],p="";p="notebook-filters.unitAssignments"===c?s(i.unitAssignmentsFilterTitle,"notebook-filters.unitAssignments","Unit Assignments"):"notebook-filters.notesFilter"===c?s(i.notesFilterTitle,"notebook-filters.notesFilter","Notes"):c;var u=t.activeFilters.indexOf(t.filters[l])>-1;a.filterOptions.push({value:t.filters[l],label:p,selected:u})}var d=function(t){a.$emit(e.updateFilters,t)};a.clearFilters=function(){for(var e=0;e<a.filterOptions.length;e++)a.filterOptions[e].selected=!1;d([])},a.toggleCheckKB=function(e,t){!e||e.keyCode!==o.ENTER&&e.keyCode!==o.SPACE||a.toggleCheck(e,t)},a.toggleCheck=function(e,t){e&&(e.preventDefault(),e.stopPropagation()),t.selected=!t.selected;var o=a.filterOptions.filter(function(e){return e.selected===!0}).map(function(e){return e.value});d(o)},a.showFilterOptions=function(){return a.showAllNotesFilterOptions&&a.displayFilterOptions&&a.enableZeroPromptsAndNotesState},a.$on(e.disableFilterOptions,function(){r.showZeroStateMessages()&&(a.enableZeroPromptsAndNotesState=!1)}),a.$on(e.toggleFilterOptions,function(){a.displayFilterOptions=!a.displayFilterOptions})}}}angular.module("Notebook.promptsFilter",[]).directive("notebookPromptsFilter",["NotebookEvents","NotebookAllNotesService","KeyboardEvents","localizeFilter","NotebookUIConfigService",e])}(),function(){"use strict";function e(e,t,o){return{templateUrl:"views/savedPrompt/savedPrompt.dir.html",restrict:"EA",scope:{prompt:"=nbPrompt",enableMoreLess:"=",isSelected:"=",searchTerm:"@"},link:function(n){n.expanded=!0;var r,a,i,s=n.prompt.content.replace(/<br \/>$/,""),l=(n.prompt.content.match(/(<br[ \/]*>)/g)||[]).length-1;n.content=s;var c=function(e){for(var t=e.replace(/<(?:.|\n)*?>/gm,""),o=[/\&amp;/g,/\&quot;/g,/\&lt;/g,/\&gt;/g,/\&nbsp;/g],n=["&",'"',"<",">"," "],r=0;r<o.length;r++)t=t.replace(o[r],n[r]);return t.length};l=l<0?0:l,r=c(n.prompt.content)+l,a=e.moreViewCharCount,n.showMoreLess=n.enableMoreLess&&r>a,i=a-(r>a?l:0),n.toggle=function(e){n.expanded=!n.expanded,n.content=n.expanded?s:t(s,i,""),e&&(e.preventDefault(),e.stopPropagation())},n.toggleKB=function(e){e.keyCode===o.ENTER&&n.toggle(e)},n.getMoreLessMessage=function(){return n.expanded?{code:"notebook-labels.lessLabel",defaultLabel:"Less"}:{code:"notebook-labels.moreLable",defaultLabel:"More..."}},n.showMoreLess&&n.toggle(null)}}}angular.module("Notebook.savedPrompt",[]).directive("notebookSavedPrompt",["NotebookConfig","noteBookTruncateFilter","KeyboardEvents",e])}(),function(){"use strict";function e(e,t,o,n,r){var a=function(t){return e.allowedCharCount-t._getLength()};return{templateUrl:"views/textPrompt/textPrompt.dir.html",restrict:"EA",scope:{prompt:"=nbPrompt",isSelected:"=isSelected"},link:function(e,i){var s=null,l=function(){(e.prompt.objectId||e.prompt.content)&&(e.prompt.isSaveInProgress||(e.$emit(t.autoSave,e.prompt),o.cancel(s),s=null))},c=function(){o.cancel(s),s=o(l,2e3)},p=i.find("[id^=jetRichtext-]").richText("instance"),u=i.find(".rte-editbox");o(function(){e.prompt.remainingCount=a(p)},0);var d=function(){o(function(){e.prompt.remainingCount=a(p)},0)};e.$watch("prompt.content",function(e,t){e===t||r.highlightClassExists(t)||(d(),c())}),u.on("keydown paste cut drop",function(o){e.$emit(t.focusEditor,e.prompt),n.handleIEEditorEvents(u,o)}),n.callEditorClickForIPAD(i,e.prompt),e.$on(t.save,function(t,n){n===e.prompt&&(o.cancel(s),s=null)}),e.$on("$destroy",function(){s&&(o.cancel(s),l())})}}}angular.module("Notebook.textPrompt",["JetRichtextEditor"]).directive("notebookTextPrompt",["NotebookConfig","NotebookEvents","$timeout","NotebookBrowserSpecificService","NotebookUtilService",e])}(),function(){"use strict";function e(e,t){return{templateUrl:"views/unitTitle/unitTitle.dir.html",restrict:"AE",scope:{unit:"=",expand:"@showPrompts",containerId:"@"},link:function(o){o.prompts=[];var n=function(){o.notesCount=e.getNotesCount(o.prompts)},r=function(){o.dataLoadComplete&&(o.prompts=e.getPromptsForUnit(o.unit.unitId),n(),o.$broadcast(t.filtersUpdateComplete))};o.$on(t.filtersUpdated,function(){r()}),o.$on(t.noteUpdated,function(){n()}),o.$on(t.noteSaved,function(){n()}),o.$on(t.displayTypeUpdated,function(e,t){t&&t.unitId&&t.unitId===o.unit.unitId&&(o.dataLoadComplete=!0,r())}),o.showNoteCount=function(){return o.dataLoadComplete&&o.notesCount>0},o.toggleExpand=function(){e.getAllNotesDataLoadComplete()?o.dataLoadComplete?o.expand="true"===o.expand?"false":"true":(o.dataLoadComplete=!0,r()):o.unit.unitId===e.getSelectedUnitId()&&(o.expand="true"===o.expand?"false":"true")},o.getNotesLabel=function(){return o.notesCount>1?{code:"notebook-labels.notesLabel",defaultLabel:"Notes"}:{code:"notebook-labels.noteLabel",defaultLabel:"Note"}},o.$on(t.noteArchived,function(){n()}),o.$on(t.noteUnArchived,function(){n()})}}}angular.module("Notebook.allNotesUnitList",["Notebook.allNotes.service"]).directive("notebookUnitList",["NotebookAllNotesService","NotebookEvents",e])}(),function(){"use strict";var e=function(e){var t=this,o=e.domainPath+e.apiBasePath,n=function(e){return o+e},r=function(e,t){return angular.forEach(t,function(t,o){e=e.replace(":"+o,t)}),e},a=function(e){var t=[];return angular.forEach(e,function(e,o){e&&o&&t.push(o+"="+e)}),t.join("&")};t.queryApi=function(t,o){var i=e.queryApi;return t&&(i=r(i,t)),o&&(i+="?"+a(o)),n(i)}};angular.module("CI.api.service",[]).service("CIApiService",["CIConfig",e])}(),function(){"use strict";angular.module("CI.Config",[]).provider("CIConfig",function(){var e={domainPath:"",apiBasePath:"/api/v2",app:"",queryApi:"/search/notebook/app/:appId/books/:bookId",queryBatchSize:200};this.set=function(t,o){e[t]=o},this.$get=function(){return e}})}(),function(){"use strict";angular.module("CIApp",["CI.Config","CI.api.service","CI.query.service"])}(),function(){"use strict";var e=function(e,t,o,n){var r,a,i,s,l=this,c=n.app,p=function(l,p){p.queryParams.startIndex=a,p.queryParams.size=i,p.pathVariables.appId=c;var u=o.queryApi(p.pathVariables,p.queryParams);return e.get(u).then(function(e){var t=e.data.data.wordHits;return r+=e.data.data.contents.length,e.data.data.totalCount<n.queryBatchSize||r===e.data.data.totalCount?(s=s.concat(e.data.data.contents),[s,t]):(a=r,s=s.concat(e.data.data.contents),l(l,p))},function(e){return t.reject(e)})};l.query=function(e){return r=0,a=0,i=n.queryBatchSize,s=[],p(p,e)}};angular.module("CI.query.service",[]).service("CIQueryService",["$http","$q","CIApiService","CIConfig",e])}(),angular.module("NotebookApp").run(["$templateCache",function(e){e.put("views/allNotes/allNotes.dir.html",'<notebook-all-notes-header ng-if=showAllNotesHeader search-term=searchTerm errors=errors></notebook-all-notes-header><div id=all-notes-container class=notebook-all-notes tabindex=-1><notebook-prompts-filter ng-if=!showLoader></notebook-prompts-filter><notebook-headsup-message ng-if=showAllNotesHeadsupMsg is-all-notes=true></notebook-headsup-message><notebook-message-overlay ng-if=!showLoader role=alert aria-live=assertive></notebook-message-overlay><ul class=notebook-list ng-if="!showLoader && displayType === \'toc\'"><li ng-repeat="unit in toc" class=notebook-allnotes-container><notebook-unit-list unit=unit show-prompts="{{unit.unitId === selectedTocId}}" container-id={{containerId}}></notebook-unit-list></li></ul><notebook-zero-state nb-zero-state=zeroState ng-if=showZeroState></notebook-zero-state><notebook-all-notes-paginated-list ng-if="displayType === \'date\'" display-type=date container-id={{containerId}} show-filter-message={{showZeroState}}></notebook-all-notes-paginated-list><ng-include ng-if="displayType === \'search\'" src="::\'views/allNotes/searchResultsHeader.html\'"></ng-include><notebook-all-notes-paginated-list search-term={{searchTerm.resultDisplayValue}} display-type=search container-id={{containerId}} ng-if="displayType === \'search\'"></notebook-all-notes-paginated-list><ng-include ng-if=showLoader src="::\'views/allNotes/allNotesLoader.html\'"></ng-include></div>'),e.put("views/allNotes/allNotesLoader.html","<div class=notebook-all-notes-loader>{{'notebook-labels.loading' | localize:[]:'Loading...'}}</div>"),e.put("views/allNotes/searchResultsHeader.html","<div class=notebook-allnotes-search-results-header>{{'notebook-labels.allNotesSearchResult' | localize:[]:'Search Results'}}<div class=notebook-allnotes-search-results-count-text><span ng-if=\"searchCount > 1\">{{searchCount}} {{'notebook-alerts.allNotesSearchResultsMsg' | localize:[]:'search results for '}}</span> <span ng-if=\"searchCount <= 1\">{{searchCount}} {{'notebook-alerts.allNotesSearchResultMsg' | localize:[]:'search result for '}}</span> <span class=notebook-allnotes-search-results-searchterm>{{searchTerm.resultDisplayValue}}</span></div><div class=notebook-allnotes-search-results-count-text><span ng-if=errors.lessCharacter>{{'notebook-error.allNotesSearchMinCharacter' | localize:[]:'Please enter more than two characters.' }}</span> <span ng-if=errors.invalidSearch>{{'notebook-error.allNotesSearchInvalidQuery' | localize:[]:'You could try searching for another keyword.' }}</span></div></div>"),e.put("views/allNotesDisplayOptions/allNotesDisplayOptions.dir.html","<div class=notebook-allnotes-filters><a href=\"javascript://\" aria-label=\"{{'notebook-links.allNotesTocLabel' | localize:[]:'Sort by table of contents'}}\" title=\"{{'notebook-links.allNotesTocLabel' | localize:[]:'Sort by table of contents'}}\" ng-click=\"changeDisplayType($event, 'toc')\" ng-class=\"displayType === 'toc' || displayType === 'search' ? 'toc-filter-active':'toc-filter'\"><span>{{'notebook-links.allNotesToc' | localize:[]:'Table of Contents'}}</span></a> <a href=\"javascript://\" aria-label=\"{{'notebook-links.allNotesDateLabel' | localize:[]:'Sort by date'}}\" title=\"{{'notebook-links.allNotesDateLabel' | localize:[]:'Sort by date'}}\" ng-click=\"changeDisplayType($event, 'date')\" ng-class=\"displayType === 'date' ? 'date-filter-active':'date-filter'\"><span>{{'notebook-links.allNotesDate' | localize:[]:'Date'}}</span></a> <button class=\"notebook-allnotes-filter-toggle pull-right\" aria-label=\"{{'notebook-links.allNotesFilterLabel' | localize:[]:'Toggle filter options'}}\" title=\"{{'notebook-links.allNotesFilterLabel' | localize:[]:'Toggle filter options'}}\" aria-expanded={{displayFilterOptions}} ng-click=toggleFilterOptions() ng-if=showFilterToggle><span class=notebook-allnotes-filter-text>{{'notebook-links.allNotesFilter' | localize:[]:'Filter'}}</span></button><div class=icon-avatar_down ng-if=\"displayFilterOptions && showFilterToggle\"></div></div>"),e.put("views/allNotesHeader/allNotesHeader.dir.html",'<div class=notebook-allnotes-navbar><span class="icon-notebook allnotes-note-book notebook-icon"></span><h1 class=allnotes-title>{{\'notebook-headers.mainHeader\' | localize:[]:\'Notebook\'}}</h1><a href="javascript://" role=button class="icon-menu_close allnotes-close" aria-label=close ng-click=onCloseAllNotes() ng-keypress=onCloseAllNotesKB($event) focus-me=true></a><div role=search class=notebook-all-notes-search><span class=notebook-all-notes-search-icon ng-class="{\'menu-focus\':search.isfocus}" aria-label="{{\'notebook-labels.allNotesSearch\' | localize:[]:\'Search Notebook\'}}"><i class=icon-search></i></span> <input type=search class=notebook-all-notes-input-search aria-label="{{\'notebook-labels.allNotesSearch\' | localize:[]:\'Search Notebook\'}}" autocomplete=off placeholder="{{\'notebook-labels.allNotesSearch\' | localize:[]:\'Search Notebook\'}}" ng-model=searchTerm.inputDisplayValue name=searchbar ng-focus="search.isfocus=true" ng-blur="search.isfocus=false" ng-keydown=searchTermEnteredKB($event) id=notebook-all-notes-input-search maxlength=100 ng-click=searchFocus()> <button class="icon-menu_close clear-search" aria-label=clear ng-click=clearSearchTerm() ng-if=!!searchTerm.inputDisplayValue></button></div></div>'),e.put("views/allNotesPaginatedList/allNotesPaginatedList.dir.html",'<notebook-list container=all-notes prompts=pagePrompts search-term={{searchTerm}} ng-if="(pagePrompts && pagePrompts.length > 0)" display-type={{displayType}} container-id={{containerId}}></notebook-list><div class=notebook-all-notes-date-error ng-if="displayType !== \'search\' && !(pagePrompts && pagePrompts.length>0) && !showFilterMessage">{{getErrorLabel().code | localize:[]: getErrorLabel().defaultLabel}}</div><notebook-all-notes-pagination-footer></notebook-all-notes-pagination-footer>'),e.put("views/allNotesPaginationFooter/allNotesPaginationFooter.dir.html",'<div class=notebook-allnotes-pagination-container><ul class=notebook-allnotes-pagination ng-if="1 < pages.length"><li ng-if="pagination.current != 1 && pages.length > paginationBarLimit" ng-click=setCurrentPage(1) ng-keydown=setCurrentPageKB($event,1)><a href="javascript://" aria-label="First page">&laquo;</a></li><li ng-if="pagination.current != 1 && pages.length > paginationBarLimit" ng-click="setCurrentPage(pagination.current - 1)" ng-keydown="setCurrentPageKB($event, pagination.current - 1)"><a href="javascript://" aria-label="Previous page">&lsaquo;</a></li><li class=notebook-allnotes-pagination-page-number ng-repeat="pageNumber in pages track by $index" ng-if=canShowPageNumber($index+1) ng-class="{ active : pagination.current == $index+1}" ng-click="setCurrentPage($index + 1)" ng-keydown="setCurrentPageKB($event, $index + 1)"><a href="javascript://" ng-bind="{{ $index + 1 }}"></a></li><li ng-if="pagination.current != pagination.last && pages.length > paginationBarLimit" ng-click="setCurrentPage(pagination.current + 1)" ng-keydown="setCurrentPageKB($event, pagination.current + 1)"><a href="javascript://" aria-label="Next page">&rsaquo;</a></li><li ng-if="pagination.current != pagination.last && pages.length > paginationBarLimit" ng-click=setCurrentPage(pagination.last) ng-keydown="setCurrentPageKB($event, pagination.last)"><a href="javascript://" aria-label="Last page">&raquo;</a></li></ul></div>'),e.put("views/listing/allNotesList.html",'<ul ng-class="displayType === \'toc\' ? \'notebook-allnotes-toc-list\' : \'notebook-allnotes-date-list\'"><div infinite-scroll=scrollToNextPage() infinite-scroll-disabled=scrollDisable infinite-scroll-container=getInfiniteScrollContainer() ng-if="isDisplayTOC() && prompts.length"><li ng-repeat="prompt in prompts | limitTo: scrolledCount"><notebook-prompt nb-prompt=prompt is-selected="selectedPrompt==prompt" template-url=views/prompt/allNotesPrompt.html display-type={{displayType}} search-term={{searchTerm}} zero-state=zeroState></notebook-prompt></li></div><li ng-repeat="prompt in prompts" ng-if=!isDisplayTOC()><notebook-prompt nb-prompt=prompt is-selected="selectedPrompt==prompt" template-url=views/prompt/allNotesPrompt.html display-type={{displayType}} search-term={{searchTerm}} zero-state=zeroState></notebook-prompt></li></ul>'),
e.put("views/listing/list.html",'<div class=notebook-list-container id=notebook-list-container><ul class=notebook-list><li ng-if=showHeadsupMsg><notebook-headsup-message is-all-notes=false></notebook-headsup-message></li><li ng-repeat="prompt in prompts"><notebook-prompt nb-prompt=prompt enable-more-less=enableMoreLess is-selected="selectedPrompt==prompt"></notebook-prompt></li></ul></div>'),e.put("views/messageOverlay/messageOverlay.dir.html","<div class=notebook-all-notes-notification-alert ng-if=showNotification ng-attr-style=top:{{positionTop}}><div class=notebook-all-notes-notification-alert-container><div class=notebook-pull-left><span class=icon-checkmark></span></div><span class=notebook-all-notes-notification-alert-success>{{'notebook-alerts.allNotesSuccess' | localize:[]:'Success!'}}</span> {{'notebook-alerts.allNotesSuccessAlert' | localize:[]:'You saved an entry.'}}</div></div>"),e.put("views/notebookZeroState/notebookZeroState.dir.html","<div ng-class=nbZeroState.className>{{nbZeroState.messageKey | localize:[]:nbZeroState.defaultMessage}}</div>"),e.put("views/notificationMessage/notificationMessage.dir.html","<div class=notebook-notification-alert role=alert aria-live=assertive ng-if=prompt.showNotification>{{'notebook-alerts.sidebarSuccess' | localize:[]:'Success! You saved an entry.'}}</div>"),e.put("views/panel/panel.dir.html","<div class=notebook-menu-title><span>{{'notebook-headers.mainHeader' | localize:[]:'Notebook'}}</span></div><div class=notebook-panel-container><button class=\"notebook-menu-button notebook-all-notes-button\" ng-click=onAllNotes()><span class=\"notebook-icon icon-notebook\"></span> <span class=notebook-button-text>{{'notebook-links.allNotes' | localize:[]:'All Notes'}}</span></button> <button class=\"notebook-menu-button notebook-pull-right\" ng-disabled=isAddNoteDisabled() ng-click=onAddNote()><span class=\"notebook-icon icon-add_note\"></span> <span class=notebook-button-text>{{'notebook-links.addNotes' | localize:[]:'Add Note'}}</span></button></div><div class=notebook-menu-chapter-title><span class=title>{{nbmenuChapterTitle}}</span> <span class=count ng-if=notesCount>{{notesCount}} {{getNotesLabel().code | localize:[]: getNotesLabel().defaultLabel}}</span></div><notebook-list container=list></notebook-list>"),e.put("views/prompt/allNotesPrompt.html","<ng-include ng-if=isNoteDeleted() src=\"::'views/prompt/noteDeleted.html'\"></ng-include><div ng-if=isPromptUnArchieved() class=notebook-allnotes-prompt-container><ng-include src=\"::'views/prompt/breadcrumb.html'\"></ng-include><div class=notebook-allnotes-prompt-content><div ng-if=\"::prompt.contentType === 'p'\" class=notebook-allnotes-prompt-title><span class=question-box aria-label=question>?</span> <span class=prompt-title ng-bind-html=::prompt.htmlTitle></span></div><ng-include ng-if=isTextPrompt() src=\"::'views/prompt/textPrompt.html'\"></ng-include><ng-include ng-if=isSavedPrompt() src=\"::'views/prompt/savedPrompt.html'\"></ng-include><ng-include ng-if=isDeletedPrompt() src=\"::'views/prompt/promptDeleted.html'\"></ng-include><ng-include ng-if=isUnEditablePrompt() src=\"::'views/prompt/promptNonEditable.html'\"></ng-include></div></div>"),e.put("views/prompt/breadcrumb.html","<div class=notebook-allnotes-breadcrumb-panel><span ng-class=\"{'notebook-allnotes-prompt-indicator' : prompt.contentType === 'p', 'notebook-allnotes-note-indicator' : prompt.contentType === 'n'}\" aria-title={{prompt.contentLabel}} aria-label={{prompt.contentLabel}}></span> <button class=notebook-allnotes-breadcrumb ng-if=\"::((prompt.contentType === 'p' || !prompt.archived) && !prompt.isNotEditable)\" ng-click=onUnitClicked(prompt) ng-bind-html=::prompt.breadCrumb></button> <span href=\"javascript://\" class=notebook-allnotes-breadcrumb ng-if=::prompt.isNotEditable ng-bind-html=::prompt.breadCrumb></span> <button class=\"icon-delete notebook-delete-button notebook-pull-right\" ng-click=onDelete(prompt) aria-label=\"{{'notebook-links.allNotesDelete' | localize:[]:'Delete'}}\" ng-if=\"!prompt.isNotEditable && showDeleteButton()\" focus-me={{::unArchive}} title=\"{{'notebook-links.allNotesDelete' | localize:[]:'Delete'}}\"></button></div>"),e.put("views/prompt/noteDeleted.html","<div class=notebook-allnotes-deleted-note tabindex=0 aria-labelledby=note-removed-id ng-attr-id=prompt-{{prompt.objectId}}><span id=note-removed-id>{{'notebook-alerts.allNotedNoteDeletedMsg' | localize:[]:'This note has been removed from your notebook.'}}</span> <button class=\"notebook-allnotes-undo-icon icon-undo\" ng-click=\"onUndo($event, prompt);\" focus-me={{focusDelete}}>{{'notebook-links.allNotesUndo' | localize:[]:'Undo'}}</button></div>"),e.put("views/prompt/prompt.html","<div class=notebook-prompt-container><notebook-notification-message role=alert aria-live=assertive></notebook-notification-message><div ng-if=\"::prompt.contentType === 'p'\" class=notebook-question-prompt ng-attr-id=title-{{::prompt.promptId}} ng-bind-html=::prompt.htmlTitle></div><ng-include ng-if=isTextPrompt() src=\"::'views/prompt/textPrompt.html'\"></ng-include><ng-include ng-if=isSavedPrompt() src=\"::'views/prompt/savedPrompt.html'\"></ng-include><ng-include ng-if=isUnEditablePrompt() src=\"::'views/prompt/promptNonEditable.html'\"></ng-include></div>"),e.put("views/prompt/promptDeleted.html","<div class=notebook-allnotes-deleted-prompt aria-labelledby=prompt-removed-id tabindex=0 ng-attr-id=prompt-{{prompt.objectId}}><span id=prompt-removed-id>{{'notebook-alerts.allNotesPromptDeletedMsg' | localize:[]:'The response has been removed.'}}</span> <button role=button class=notebook-allnotes-breadcrumb ng-click=\"newPromptAfterDelete($event, prompt)\">{{'notebook-links.allNotesWriteNewPrompt' | localize:[]:'Write a new one?'}}</button> <button role=button class=\"notebook-allnotes-undo-icon icon-undo\" ng-click=\"onUndo($event, prompt);style={cursor:'default'}\" focus-me={{focusDelete}}>{{'notebook-links.allNotesUndo' | localize:[]:'Undo'}}</button></div>"),e.put("views/prompt/promptNonEditable.html","<div class=notebook-saved-prompt><notebook-saved-prompt nb-prompt=prompt enable-more-less=enableMoreLess></notebook-saved-prompt><notebook-zero-state nb-zero-state=zeroState ng-if=showZeroStateMsg()></notebook-zero-state></div><div class=notebook-all-notes-saved-footer ng-bind-template=\"{{::prompt.updated | date:'MM/dd/yy h:mma' | lowercase}}\" ng-if=!showZeroStateMsg()></div>"),e.put("views/prompt/savedPrompt.html",'<div tabindex=0 role=button title="Edit Note" aria-label="Edit Note" aria-describedby="prompt-{{::prompt.objectId}} notebook-all-notes-saved-footer-{{::prompt.objectId}}" ng-keyup="enterEditPrompt($event, prompt)"><div class=notebook-saved-prompt tabindex=-1 ng-click=editPrompt(prompt) ng-attr-id=prompt-{{::prompt.objectId}}><notebook-saved-prompt nb-prompt=prompt enable-more-less=enableMoreLess selected-prompt-id=selectedPromptId is-selected=isSelected search-term={{searchTerm}}></notebook-saved-prompt></div><div tabindex=-1 id=notebook-all-notes-saved-footer-{{::prompt.objectId}} class=notebook-all-notes-saved-footer ng-bind-template="{{::prompt.updated | date:\'MM/dd/yy h:mma\' | lowercase}}"></div></div>'),e.put("views/prompt/textPrompt.html","<div ng-attr-id=\"prompt-{{ prompt.promptId || prompt.objectId || prompt.tempId}}\"><notebook-text-prompt nb-prompt=prompt is-selected=isSelected ng-click=editorClick(prompt) ng-keyup=\"enterEditorClick($event, prompt)\" display-type={{displayType}} search-term=searchTerm></notebook-text-prompt><div class=notebook-prompt-footer><div class=notebook-save-message-container role=alert aria-atomic=true ng-if=prompt.showSaveMessage>{{getSaveLabel().code | localize:[]: getSaveLabel().defaultLabel}} <span ng-if=\"prompt.remainingCount > -1\">{{prompt.remainingCount}}{{'notebook-labels.charactersRemaining' | localize:[]:'Characters remaining'}}</span> <span ng-if=\"prompt.remainingCount < 0\">{{prompt.remainingCount.toString().replace('-', '')}} {{'notebook-labels.charactersExceeded' | localize:[]:'Characters exceeded'}}</span></div><div class=notebook-counter-save-container><span ng-class=\"{true:'notebook-char-counter-limit-crossed', false: 'notebook-char-counter'} [prompt.remainingCount <= 50]\" ng-bind=prompt.remainingCount></span> <button class=notebook-done-button ng-disabled=isDoneDisabled(prompt) ng-click=onSave(prompt)>{{'notebook-links.done' | localize:[]:'Done'}}</button></div></div></div>"),e.put("views/promptsFilter/promptsFilter.dir.html",'<notebook-all-notes-display-options ng-if=showAllNotesDisplayTypeOptions></notebook-all-notes-display-options><div ng-if=showFilterOptions() class=notebook-allnotes-filter-options><span class=notebook-allnotes-filters-container><span ng-repeat="filter in filterOptions" class=notebook-allnotes-cb-container><span class=notebook-pull-right ng-class="{\'notebook-allnotes-prompt-indicator\' : filter.value === \'notebook-filters.unitAssignments\', \'notebook-allnotes-note-indicator\' : filter.value === \'notebook-filters.notesFilter\'}" ng-click="toggleCheck($event, filter)"></span> <span class="notebook-pull-right notebook-allnotes-filter-label" ng-click="toggleCheck($event, filter)">{{filter.label}}</span> <span class="notebook-allnotes-filter-checkbox notebook-pull-right" ng-keydown="toggleCheckKB($event, filter)"><input type=checkbox name=filter value={{filter.label}} tabindex=0 id=notebook-cb-{{$index}} ng-model=filter.selected aria-label={{filter.label}} ng-attr-aria-checked={{filter.selected}}> <label aria-label={{filter.label}} for=notebook-cb-{{$index}} ng-click="toggleCheck($event, filter)"></label></span></span> <span class="notebook-pull-right notebook-allnotes-btn-container"><button ng-click=clearFilters() role=button class=notebook-allnotes-clear-filter>{{\'notebook-links.allNotesClearFilters\' | localize:[]:\'Clear Filters\'}}</button></span></span></div>'),e.put("views/savedPrompt/savedPrompt.dir.html",'<div ng-if=::prompt.isNotEditable class=notebook-saved-prompt-container focus-me=isSelected><span ng-bind-html=content></span></div><div ng-if=::!prompt.isNotEditable class=notebook-saved-prompt-container focus-me=isSelected><span ng-bind-html="content | notebookHighlight"></span></div><a href="javascript://" aria-label="{{getMoreLessMessage().code | localize:[]:getMoreLessMessage().defaultLabel}}" ng-if=showMoreLess ng-click=toggle($event) ng-keydown=toggleKB($event) class=notebook-more-less>{{getMoreLessMessage().code | localize:[]:getMoreLessMessage().defaultLabel}}</a>'),e.put("views/textPrompt/textPrompt.dir.html",'<div class=notebook-rte-prompt ng-class="{active : isSelected}"><div jet-richtext-editor ng-model=prompt.content max-chars=1050 ng-attr-focus-editor={{isSelected}}></div></div>'),e.put("views/unitTitle/unitTitle.dir.html","<h2 class=notebook-allnotes-unit-row><div class=notebook-allnotes-unit-row-container><div class=notebook-allnotes-slider><button id=unit-{{::unit.unitId}} ng-click=toggleExpand() ng-class=\"dataLoadComplete === true && expand === 'true' ? 'icon-avatar_down notebook-allnotes-icon-triangle-bottom' : 'icon-avatar_down notebook-allnotes-icon-triangle-right'\" aria-expanded={{expand}} role=button aria-label={{::unit.title}}></button></div><div class=notebook-allnotes-unit-title><button ng-click=toggleExpand() role=button aria-expanded={{expand}}><div class=unit-title-holder><span class=unit-title>{{::unit.title}}</span> <span ng-if=!dataLoadComplete class=\"icon-refresh prompt-count spinning\"></span> <span ng-if=showNoteCount() class=prompt-count>{{notesCount}} {{getNotesLabel().code | localize:[]: getNotesLabel().defaultLabel}}</span></div></button></div></div></h2><notebook-list ng-if=\"expand === 'true'\" container=all-notes prompts=prompts display-type=toc container-id={{containerId}}></notebook-list><div ng-if=\"(dataLoadComplete === true && expand === 'true' && !(prompts && prompts.length>0))\" class=notebook-all-notes-error>{{'notebook-error.allNotesNoDataForFilter' | localize:[]:'No data for selected filter.'}}</div>")}]);