angular.module("Discuss.paths",[]).constant("DISCUSS_ROOT_PATH","/discuss"),angular.module("Discuss.templates",["Discuss.paths"]),angular.module("DiscussApp",["Discuss.templates","Discuss.Views","Discuss.Components","Discuss.SharedServices","Discuss.RestAPI","Discuss.Utils","Discuss.Model","Discuss.Filter","ngSanitize"]),angular.module("Discuss.Components",["Discuss.Header","Discuss.PostDetail","Discuss.PostParticipants","Discuss.PostReply","Discuss.PostSummary","Discuss.MoreOrLess","Discuss.EditComment","Discuss.ScrollIf","Discuss.SubmitButton","Discuss.AttachFile","Discuss.AttachOptions"]),angular.module("Discuss.CleanWysiwyg",[]).filter("cleanWysiwyg",function(){"use strict";return function(t){var e=t.replace(" />",">");return e}}),angular.module("Discuss.Filter",[]).filter("filteredPostVisibility",function(){"use strict";return function(t,e){if(t){var s,i,n=[];for(i=0;i<t.length;i++)s=t[i],(e&&(!s.hide||angular.isDefined(s.isUndo)&&s.isUndo)||!e&&s.hide)&&n.push(s);return n}}}),angular.module("Discuss.Board",["Discuss.PostCollection"]).factory("DiscussBoard",["$log","DiscussPostCollection",function(t,e){"use strict";function s(t){e.call(this,t)}return s.prototype=Object.create(e.prototype),s.prototype.constructor=s,s}]),angular.module("Discuss.Model.Customizations",[]).provider("DiscussModelCustomizations",function(){"use strict";var t;t=function(){return function(t){return t}},this.setServiceThatTransformsPosts=function(e){t=e},this.$get=["$injector","$q",function(e,s){var i={};return i.transformPostsIn=function(i){return s.when(e.invoke(t)(i)).catch(function(){return i})},i}]}),angular.module("Discuss.Model",["Discuss.Post","Discuss.Board","Discuss.Model.Customizations","Discuss.Thumbnail.Customizations"]),angular.module("Discuss.Post",["Discuss.Utils.DisplayTime","Discuss.Utils.Localization.LocalizeFilter","Discuss.PostDetail.Svc"]).factory("DiscussPost",["$filter","MomentConfigs",function(t,e){"use strict";function s(t){angular.copy(t,this)}return s.prototype.$archive=function(){var t=this;t.archived=!0},s.prototype.$unarchive=function(){var t=this;t.archived=!1},s.prototype.$hide=function(){var t=this;t.isUndo=t.hide=!0},s.prototype.$unhide=function(){var t=this;t.hide=t.isUndo=!1},s.prototype.$copy=function(t){var e,s=this;for(e in t)t.hasOwnProperty(e)&&(s[e]=t[e])},s.prototype.$formatPostDay=function(){var t=this;return e.customDate(t.modifiedDate)},s.prototype.$formatPostTime=function(){var t=this;return moment(t.modifiedDate).format("h:mm a")},s.prototype.$formatCreateDate=function(){var t=this;return moment(t.createDate).format("dddd, MMMM D, YYYY")},s.prototype.$isReply=function(){var t=this;return null!==t.parentId},s.prototype.$getEditedLabel=function(){var e=this,s=0!==moment(e.modifiedDate).diff(moment(e.createDate)),i=t("discussLocalize")("post-detail.post-info.editedLabel");return s?i:""},s.prototype.$hasBodyChanged=function(t){var e=this;return e.body!==t},s.prototype.$hasPostChanged=function(t,e){var s=this,i=s.meta.attachment||{};return s.body!==t||!angular.equals(i,e)},s.prototype.$removeIsUndoState=function(){var t=this;delete t.isUndo},s.prototype.$isUndoStateOn=function(){var t=this;return!!t.isUndo},s.prototype.$isHidden=function(){var t=this;return!!t.hide},s.prototype.$isArchived=function(){var t=this;return!!t.archived},s.prototype.$getAuthorDisplayName=function(){return angular.isUndefined(this.authorDisplayName)?this.author:this.authorDisplayName},s.prototype.getAuthorId=function(){return this.author},s.prototype.$getDisplayName=function(){return angular.isUndefined(this.displayNameForComments)?this.author:this.displayNameForComments},s.prototype.$getAuthorAvatarUrl=function(){var t="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQwIiBoZWlnaHQ9IjkwIiB2aWV3Qm94PSIwIDAgMTQwIDkwIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIj48ZGVmcy8+PHJlY3Qgd2lkdGg9IjE0MCIgaGVpZ2h0PSI5MCIgZmlsbD0iI0VFRUVFRSIvPjxnPjx0ZXh0IHg9IjQ5LjUiIHk9IjQ1IiBzdHlsZT0iZmlsbDojQUFBQUFBO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1mYW1pbHk6QXJpYWwsIEhlbHZldGljYSwgT3BlbiBTYW5zLCBzYW5zLXNlcmlmLCBtb25vc3BhY2U7Zm9udC1zaXplOjEycHg7ZG9taW5hbnQtYmFzZWxpbmU6Y2VudHJhbCI+MTQweDkwPC90ZXh0PjwvZz48L3N2Zz4=";return angular.isUndefined(this.customAuthorAvatarUrl)?t:this.customAuthorAvatarUrl},s}]),angular.module("Discuss.PostCollection",["Discuss.Post"]).factory("DiscussPostCollection",["DiscussPost",function(t){"use strict";function e(t){angular.copy(t,this);var e=[];angular.forEach(t.posts,function(t){s(t,e)}),this.posts=e}var s=function(e,s){var i=e instanceof t?e:new t(e);return s.push(i),i};e.prototype.$getPostById=function(t){var e=this,s=_.findWhere(e.posts,{id:t});return s},e.prototype.$addPost=function(t){var e=this,i=e.$getPostById(t.id),n=angular.isDefined(i);return n?i:s(t,e.posts)},e.prototype.$upsertPost=function(t){var e=this,s=e.$getPostById(t.id),i=angular.isDefined(s);return i?s.$copy(t):e.$addPost(t)},e.prototype.$upsertPosts=function(t){var e=this;angular.forEach(t,function(t){e.$upsertPost(t)})},e.prototype.$unarchivePost=function(t){var e=this,s=e.$getPostById(t.id),i=angular.isDefined(s);i&&s.$unarchive()},e.prototype.$archivePost=function(t){var e=this,s=e.$addPost(t);s.$archive()},e.prototype.$hidePost=function(t){var e=this,s=e.$addPost(t);s.$hide()},e.prototype.$unhidePost=function(t){var e=this,s=e.$addPost(t);s.$unhide()},e.prototype.$copyPosts=function(t){var s=this,i=t instanceof e?t:new e(t);angular.forEach(i.posts,function(t){s.$upsertPost(t)}),s.posts=_.reject(s.posts,function(t){return!i.$getPostById(t.id)&&!t.$isArchived()})},e.prototype.$getVisiblePosts=function(){var t=this,e=_.filter(t.posts,function(t){return!t.$isHidden()});return e},e.prototype.$getHiddenPosts=function(){var t=this,e=_.filter(t.posts,function(t){return t.$isHidden()});return e},e.prototype.$getArchivedPosts=function(){var t=this,e=_.filter(t.posts,function(t){return t.$isArchived()});return e},e.prototype.$getTotalPostsCount=function(){var t=this;return t.posts.length},e.prototype.$getCurrentPostsCount=function(){var t=this;return t.posts.length-t.$getArchivedPosts().length-t.$getHiddenPosts().length},e.prototype.$removeIsUndoStateFromPosts=function(){var t=this;angular.forEach(t.posts,function(t){t.$removeIsUndoState()})};var i=function(t,e){return _.chain(t).map(function(t){return e?t.getAuthorId():t.$getAuthorDisplayName()}).reject(function(t){return _.isUndefined(t)||_.isEmpty(t)}).uniq().value()};return e.prototype.$getParticipants=function(t){var e=this;return angular.isUndefined(t)?i(e.posts,!1):t?e.$getVisiblePostParticipants():e.$getHiddenPostParticipants()},e.prototype.getVisiblePostParticipantsId=function(){var t=this,e=_.chain(t.$getVisiblePosts()).reject(function(t){return t.$isArchived()}).value();return i(e,!0)},e.prototype.$getVisiblePostParticipants=function(){var t=this,e=_.chain(t.$getVisiblePosts()).reject(function(t){return t.$isArchived()}).value();return i(e,!1)},e.prototype.$getHiddenPostParticipants=function(){var t=this,e=t.$getHiddenPosts();return i(e,!1)},e.prototype.$hasHiddenPosts=function(){var t=this;return t.$getHiddenPosts().length>0},e.prototype.$hasOnlyHiddenPosts=function(){var t=this;return 0===t.$getVisiblePosts().length&&t.$hasHiddenPosts()},e.prototype.$hasPost=function(){var t=this;return t.$getTotalPostsCount()>0},e.prototype.$hasUndoPost=function(){var t=this,e=_.filter(t.posts,function(t){return t.$isUndoStateOn()});return e.length>0},e.prototype.$forEach=function(t){var e=this;angular.forEach(e.posts,t)},e}]),angular.module("Discuss.Thread",["Discuss.Post","Discuss.PostCollection"]).factory("DiscussThread",["DiscussPost","DiscussPostCollection",function(t,e){"use strict";function s(s,i){this.thumbnail=i,this.topPost=new t(s),this.childPostCollection=new e({posts:s.posts,postCount:s.postCnt})}return s.prototype.$copy=function(t){var e=this;e.topPost.$copy(t),e.childPostCollection.postCount=t.postCnt,e.childPostCollection.$copyPosts({posts:t.posts})},s.prototype.$updateByTargetPost=function(t){var e=this;e.topPost.id===t.id?e.topPost.$copy(t):e.childPostCollection.$upsertPost(t)},s}]),angular.module("Discuss.Thumbnail.Customizations",[]).provider("DiscussThumbnailCustomizations",function(){"use strict";var t;t=function(){return function(){return""}},this.setServiceThatProvidesPostThumbnails=function(e){t=e},this.$get=["$injector","$q",function(e,s){var i={};return i.getThumbnailForPost=function(i){return s.when(e.invoke(t)(i)).catch(function(){return""})},i}]}),angular.module("Discuss.RestAPI.BasePathSvc",[]).provider("DiscussRestAPIBasePath",function(){"use strict";var t="/api/v1";this.set=function(e){t=e},this.$get=function(){var e={};return e.get=function(){return t},e}}),angular.module("Discuss.RestAPI.Endpoints",["Discuss.RestAPI.HttpCorsPolyfill","Discuss.RestAPI.BasePathSvc","Discuss.Model.Customizations","Discuss.PostDetail.Svc"]).provider("DiscussRestAPIEndpoints",function(){"use strict";var t={headers:{"Content-Type":"application/json"}};this.$get=["HttpCorsPolyfill","$q","DiscussRestAPIBasePath","DiscussModelCustomizations",function(e,s,i,n){var o={},r=i.get();o.getBoardsByExternalIds=function(t,i){var n=r+"/discussions/boards",o={externalIds:t.join(",")};return i&&(o.expand="posts"),e.get(n,{params:o}).then(function(t){return t.data},function(t){return s.reject(t)})},o.getBoards=function(t){var i=r+"/discussions/boards",n={context:t};return e.get(i,{params:n}).then(function(t){return t.data},function(t){return s.reject(t)})},o.getBoard=function(t,i){var o=r+"/discussions/boards/"+t,c={};return i&&(c.expand="posts"),e.get(o,{params:c}).then(function(t){var e=t.data;return n.transformPostsIn(e).then(function(t){return t})},function(t){return s.reject(t)})},o.createBoard=function(i){var n=r+"/discussions/boards";return e.post(n,JSON.stringify(i),t).then(function(t){return t.data},function(t){return s.reject(t)})},o.getPostsByBoard=function(t){var i=r+"/discussions/boards/"+t+"/posts";return e.get(i).then(function(t){var e=t.data;return n.transformPostsIn(e).then(function(t){return t})},function(t){return s.reject(t)})},o.getChildPosts=function(t,i){var o=r+"/discussions/boards/"+t+"/posts/"+i+"/children";return e.get(o).then(function(t){var e=t.data;return n.transformPostsIn(e).then(function(t){return t})},function(t){return s.reject(t)})},o.createPost=function(i,o){var c=r+"/discussions/boards/"+i+"/posts";return e.post(c,JSON.stringify(o),t).then(function(t){var e=t.data.data;return n.transformPostsIn(e).then(function(t){return t})},function(t){return s.reject(t)})},o.deletePost=function(t,i){var n=r+"/discussions/boards/"+t+"/posts/"+i;return e.delete(n).then(function(t){return t.data.data},function(t){return s.reject(t)})};var c=function(i,o,c){var a=r+"/discussions/boards/"+i+"/posts/"+o;return e.post(a,JSON.stringify(c),t).then(function(t){var e=t.data.data;return n.transformPostsIn(e).then(function(t){return t})},function(t){return s.reject(t)})};return o.archivePost=function(t){return c(t.boardId,t.id,{archived:!0})},o.unarchivePost=function(t){return c(t.boardId,t.id,{archived:!1})},o.editPost=function(t,e,s){return delete s.archived,delete s.hide,delete s.showUndoHideMessage,c(t,e,s)},o.hidePost=function(t){return c(t.boardId,t.id,{hide:!0})},o.unhidePost=function(t){return c(t.boardId,t.id,{hide:!1})},o.getPost=function(t,i){var o=[r+"/discussions/boards",t,"posts",i].join("/"),c={expand:"posts"};return e.get(o,{params:c}).then(function(t){var e=t.data.data;return n.transformPostsIn(e).then(function(t){return t})},function(t){return s.reject(t)})},o.createReply=function(i,o,c){var a=[r+"/discussions/boards",i,"posts",o,"children"].join("/");return e.post(a,JSON.stringify(c),t).then(function(t){var e=t.data.data;return n.transformPostsIn(e).then(function(t){return t})},function(t){return s.reject(t)})},o.getBoardByIdAndCreatePost=function(t,e,s){var i=function(){var t={context:s};return o.createBoard(t).then(function(t){return o.createPost(t.data.id,e)})};return t?o.getBoard(t).then(function(){return o.createPost(t,e)},i):i()},o.deleteAllPostsForBoard=function(t){var i=[r+"/discussions/boards",t,"posts"].join("/");return e.delete(i).then(function(t){return t.data},function(t){return s.reject(t)})},o.deleteBoard=function(t){var i=[r+"/discussions/boards",t].join("/");return e.delete(i).then(function(t){return t.data},function(t){return s.reject(t)})},o.getPostsNumberFromDiscussion=function(i){var n=[r+"/discussions/boards","posts","children","summary"].join("/"),o=angular.extend({},t);return o.params={externalIds:i.join(",")},e.get(n,o).then(function(t){return t},function(t){return s.reject(t)})},o}]}),angular.module("Discuss.RestAPI.HttpCorsPolyfill",["Discuss.RestAPI.BasePathSvc","Discuss.RestAPI.PMXDR"]).factory("HttpCorsPolyfill",["$pmxdr","$http","DiscussRestAPIBasePath",function(t,e,s){"use strict";var i=function(){var t=new XMLHttpRequest;return"withCredentials"in t},n=function(){return-1===s.get().indexOf("http")};return i()||n()?e:(pmxdr.endpoints.push({origin:s.get(),endpoint:"/realizeoauth/pmxdr/api"}),t)}]),angular.module("Discuss.RestAPI.PMXDR",[]).provider("$pmxdr",function(){"use strict";this.interceptors=[],this.$get=["$q","$rootScope","$injector",function(t,e,s){var i={},n=function(){return String.prototype.trim?function(t){return angular.isString(t)?t.trim():t}:function(t){return angular.isString(t)?t.replace(/^\s\s*/,"").replace(/\s\s*$/,""):t}}(),o=function(t){var e,s,i,o={};return t?(angular.forEach(t.split("\n"),function(t){i=t.indexOf(":"),e=angular.lowercase(n(t.substr(0,i))),s=n(t.substr(i+1)),e&&(o[e]?o[e]+=", "+s:o[e]=s)}),o):o},r=function(t){var e=angular.isObject(t)?t:void 0;return function(s){return e||(e=o(t)),s?e[angular.lowercase(s)]||null:e}},c=function(t){return t>=200&&300>t},a=function(t){var e=[];for(var s in t)t.hasOwnProperty(s)&&e.push(s);return e.sort()},u=function(t,e,s){for(var i=a(t),n=0;n<i.length;n++)e.call(s,t[i[n]],i[n]);return i},d=function(t,e){return window.encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,e?"%20":"+")},l=function(t,e){if(!e)return t;var s=[];return u(e,function(t,e){null===t||angular.isUndefined(t)||(angular.isArray(t)||(t=[t]),angular.forEach(t,function(t){angular.isObject(t)&&(t=angular.toJson(t)),s.push(d(e)+"="+d(t))}))}),t+(-1===t.indexOf("?")?"?":"&")+s.join("&")},m=function(s,i){var n=t.defer(),o=new XDR;return o.open(i.method,l(s,i.params),!0),angular.forEach(i.headers,function(t,e){angular.isDefined(t)&&o.setRequestHeader(e,t)}),o.onreadystatechange=function(){var t=function(){try{return angular.fromJson(l)}catch(t){return l}},s=function(t,e,s,i){e=0===e?s?200:404:e,e=1223===e?204:e,t(e,s,i)},a=function(e,s,o){s=Math.max(s,0),(c(s)?n.resolve:n.reject)({data:t(e),status:s,headers:r(o),config:i})},u=function(t,s,i){a(s,t,i),e.$$phase||e.$apply()};if(o&&4===o.readyState){var d=null,l=null;d=o.getAllResponseHeaders(),l="response"in o?o.response:o.responseText,s(u,o.status,l,d)}},o.send(i.data||null),n.promise},h=[];angular.forEach(this.interceptors,function(t){h.unshift(angular.isString(t)?s.get(t):s.invoke(t))});var p=function(e,s){var i=[e,void 0],n=t.when(s||{});for(angular.forEach(h,function(t){(t.request||t.requestError)&&i.unshift(t.request,t.requestError),(t.response||t.responseError)&&i.push(t.response,t.responseError)});i.length;){var o=i.shift(),r=i.shift();n=n.then(o,r)}return n};return["delete","get"].forEach(function(t){i[t]=function(e,s){return s=angular.extend(s||{},{method:t,url:e}),p(function(t){return m(e,t)},s)}}),["post","put"].forEach(function(t){i[t]=function(e,s,i){return i=angular.extend(i||{},{method:t,url:e,data:s}),p(function(t){return m(e,t)},i)}}),i}]}),angular.module("Discuss.RestAPI",["Discuss.RestAPI.HttpCorsPolyfill","Discuss.RestAPI.BasePathSvc","Discuss.RestAPI.Endpoints","Discuss.RestAPI.PMXDR"]),angular.module("Discuss.SharedServices.DataDelegate",["Discuss.RestAPI.Endpoints","Discuss.Board","Discuss.Post"]).service("DiscussDataDelegate",["DiscussRestAPIEndpoints","$rootScope","$log","$q","DiscussBoard",function(t,e,s,i,n){"use strict";var o=function(t,i){e.$broadcast(t,i),s.debug("Event broadcast: "+t+", Source: DiscussDataDelegate")};this.hidePost=function(e,s,n){return t.hidePost(e).then(function(t){e.$copy(t),e.$hide(),o(s,e)},function(t){return o(n,t),i.reject()})},this.unhidePost=function(e,s,n){return t.unhidePost(e).then(function(t){e.$copy(t),e.$unhide(),o(s,e)},function(t){return o(n,t),i.reject()})},this.isBoardEmpty=function(t){return!t.posts||0===t.posts.length},this.getBoard=function(e,s,r,c){return t.getBoard(e,!0).then(function(t){var e=new n(t.data);return e.$hasPost()||o(c),o(s,e),e},function(t){return o(r,t),i.reject()})}}]),angular.module("Discuss.SharedServices.MobileInfo",[]).service("MobileInfo",["$window",function(t){"use strict";function e(){return t.navigator?angular.lowercase(t.navigator.userAgent):""}this.OS={},Object.defineProperties(this.OS,{isIOS:{get:function(){return/(ipod|iphone|ipad)/i.test(e())}},isAndroid:{get:function(){return/(android)/i.test(e())}}}),this.isMobileDevice=this.OS.isAndroid||this.OS.isIOS}]),angular.module("Discuss.core.security.permissions",[]).constant("PERMISSIONS",{CREATE_DISCUSSION:"create_discussion",HIDE_DISCUSSION:"hide_discussion"}).provider("DiscussPermissions",[function(){"use strict";var t={};this.definePermissions=function(e){angular.forEach(e,function(e){t[e]=!1})},this.setPermissions=function(e){angular.extend(t,e)},this.addPermission=function(e,s){t[e]=s},this.$get=function(){var e=this;return e.getPermissions=function(){return angular.extend({},t)},e.hasPermission=function(e){return t[e]},e}}]),angular.module("Discuss.SharedServices",["Discuss.core.security.permissions","Discuss.SharedServices.DataDelegate","Discuss.SharedServices.MobileInfo"]),angular.module("Discuss.Utils.DisplayTime",["Discuss.Utils.Localization.LocalizeFilter","Discuss.Utils.Localization.LocalizeAsArrayFilter"]).service("MomentConfigs",["$filter",function(t){"use strict";this.customDate=function(e){return moment(e).calendar(null,{lastDay:function(){return"["+t("discussLocalize")("times.yesterday")+"]"},sameDay:function(){return"["+t("discussLocalize")("times.today")+"]"},lastWeek:"dddd",sameElse:function(){var e=moment(),s=e.diff(this,"days");return s>=7&&13>=s?"["+t("discussLocalize")("times.last")+"] dddd":this.format("MM/DD/YYYY")}})}}]).run(["DiscussLocale",function(t){"use strict";t.loadMessages()}]),angular.module("Discuss.Utils",["Discuss.Utils.DisplayTime","Discuss.Utils.Localization"]),angular.module("Discuss.Views",["Discuss.CreateView","Discuss.ListView","Discuss.ThreadView"]),function(){"use strict";function t(t,e){this.fileAttachSuccess=!1,this.fileIsDeleted=!1,this.$scope=t,this.attachment=this.attachment||{},this.uploadButtons=e.getAttachButtonsConfig(),_.isEmpty(this.attachment)||this.attachment.isDeleted||(this.selectedFile=this.attachment.name,this.fileAttachSuccess=!0),this.$scope.$on("attach.file.success",this.onAttachFileSuccess.bind(this))}angular.module("Discuss.AttachFile",["Discuss.paths","Discuss.templates","Discuss.Utils.Localization.LocalizeFilter","Discuss.AttachOptions","Discuss.AttachFile.options"]).directive("attachFile",["DISCUSS_ROOT_PATH",function(t){return{restrict:"EA",scope:{attachment:"=?"},bindToController:!0,templateUrl:t+"/components/attachment-file/attachment-file.dir.html",controller:"AttachmentFileCtrl",controllerAs:"attachmentFileCtrl"}}]).controller("AttachmentFileCtrl",t),t.$inject=["$scope","DiscussAttachmentOptions"],t.prototype.attachFile=function(t,e){this.preventDefaultIfEvent(t),this.$scope.$emit("attachment.button.triggered",{type:e})},t.prototype.onAttachFileSuccess=function(t,e){this.selectedFile=e.name,this.attachment={id:e.id,name:e.name,type:e.type||"file"},this.fileAttachSuccess=!0,this.fileIsDeleted=!1},t.prototype.removeAttachedFile=function(t){this.preventDefaultIfEvent(t),this.attachment.isDeleted=!0,this.fileIsDeleted=!0,this.$scope.$emit("attachment.file.removeAttachment")},t.prototype.undoRemovedAttachment=function(t){this.preventDefaultIfEvent(t),this.attachment.isDeleted=!1,this.fileIsDeleted=!1,this.$scope.$emit("attachment.file.undoRemovedAttachment")},t.prototype.downloadAttachedFile=function(t){this.preventDefaultIfEvent(t),this.$scope.$emit("attachment.file.download",this.attachment)},t.prototype.preventDefaultIfEvent=function(t){t&&t.preventDefault()}}(),angular.module("Discuss.AttachFile.options",[]).provider("DiscussAttachmentOptions",[function(){"use strict";var t={attachFromComputer:!0,attachFromGoogleDrive:!0,attachFromOneDrive:!0};this.allowGoogle=function(e){t.attachFromGoogleDrive=e!==!1},this.allowOnedrive=function(e){t.attachFromOneDrive=e!==!1},this.allowPC=function(e){t.attachFromComputer=e!==!1},this.configureAttachmentButtons=function(e){"attachFromGoogleDrive"in e&&(t.attachFromGoogleDrive=e.attachFromGoogleDrive),"attachFromOneDrive"in e&&(t.attachFromOneDrive=e.attachFromOneDrive),"attachFromComputer"in e&&(t.attachFromComputer=e.attachFromComputer)},this.$get=function(){var e=this;return e.getAttachButtonsConfig=function(){return angular.extend({},t)},e}}]),angular.module("Discuss.AttachOptions",["Discuss.paths","Discuss.templates","Discuss.Utils.Localization.LocalizeFilter"]).directive("attachmentOption",["DISCUSS_ROOT_PATH",function(t){"use strict";return{restrict:"E",scope:{attachmentButtons:"=?",onAttachFile:"&"},templateUrl:t+"/components/attachment-option/attachment-option.dir.html",controller:["$scope",function(t){t.attachFile=function(e,s){e&&e.preventDefault(),t.onAttachFile({$event:e,type:s})}}]}}]),angular.module("Discuss.EditComment",["Discuss.paths","Discuss.templates","Discuss.Utils.Localization.LocalizeFilter","JetRichtextEditor","Discuss.SubmitButton","Discuss.AttachFile","Discuss.PostDetail.Svc","Discuss.CleanWysiwyg"]).directive("editComment",["$log","DiscussRestAPIEndpoints","DISCUSS_ROOT_PATH","DiscussPostDetailSvc","$filter","$timeout",function(t,e,s,i,n,o){"use strict";return{restrict:"EA",scope:{post:"=",attachmentsEnabled:"=?"},templateUrl:s+"/components/edit-comment/edit-comment.html",controller:["$scope",function(s){var i=this,r=n("cleanWysiwyg");s.fileAttachSuccess=!1,s.attachmentsEnabled=s.attachmentsEnabled||!1,s.post.body=r(s.post.body),s.originalBody=s.post.body,s.originalAttachment=_.extend({},s.post.attachment)||{},s.originalPost={post:s.originalBody,attachment:s.originalAttachment},s.cancel=function(){s.post.body=s.originalBody,s.post.attachment=s.originalAttachment,s.$emit("discussion.editComment.cancel",s.post),t.debug("Event emitted: discussion.editComment.cancel, Source: editComment")},s.hasChanged=function(){return s.post.attachment&&!angular.equals(s.post.attachment.id,s.originalAttachment.id)||!angular.equals(s.post.body,s.originalBody)||s.editCommentForm.$dirty},s.submit=function(){s.hasChanged()&&s.editCommentForm.$valid&&(s.$emit("discussion.editComment.submit",s.post),t.debug("Event emitted: discussion.editComment.update, Source: editComment, Post: ",s.post),s.post.attachment.isDeleted&&(s.post.attachment={}),s.attachmentsEnabled?s.$emit("discussion.comment.updatePost",s.post):s.updatePost(s.post))},s.updatePost=function(t){return e.editPost(s.post.boardId,s.post.id,t).then(i.emitUpdateSuccessfulEvent,i.emitUpdateFailedEvent)},s.isSubmitDisabled=function(){return!!s.isUpdateInProgress||s.editCommentForm.$invalid||!s.hasChanged()},i.emitUpdateSuccessfulEvent=function(e){s.$emit("discussion.editComment.updateSuccessful",e),t.debug("Event emitted: editComment.updateSuccessful, Source: editComment")},i.emitUpdateFailedEvent=function(e){s.$emit("discussion.editComment.updateFailed",e),t.debug("Event emitted: editComment.updateFailed, Source: editComment")},i.enableUpdateSpinner=function(t){s.isUpdateInProgress=t},s.$on("discussion.comment.postUpdated",function(t,e){s.updatePost(e)}),s.$on("discussion.editComment.edit",function(t,e){s.post.showEditForm=s.post.id===e?!0:!1,s.post.showEditForm?o(function(){$("#comment-"+e).focus()},0):s.cancel()}),s.$on("discussion.editComment.enableUpdateSpinner",function(t,e){i.enableUpdateSpinner(e)}),s.$on("attachment.button.triggered",function(t,e){s.$emit("attachment.link.clicked",e)}),s.$on("discussion.attach.file.success",function(t,e){s.editCommentForm.$setDirty(),s.post.attachment={id:e.id,name:e.name,type:e.type},s.$broadcast("attach.file.success",e)}),s.$on("attachment.file.removeAttachment",function(){_.isEmpty(s.originalAttachment)?s.editCommentForm.$setPristine():s.editCommentForm.$setDirty(),s.post.attachment.isDeleted=!0}),s.$on("attachment.file.undoRemovedAttachment",function(){_.isEmpty(s.originalAttachment)?s.editCommentForm.$setDirty():s.editCommentForm.$setPristine(),s.post.attachment.isDeleted=!1}),s.$on("attachment.file.download",function(){s.$emit("discussion.attachment.file.download",s.post.attachment)})}]}}]),angular.module("Discuss.Header",["Discuss.Header.Event","Discuss.paths","Discuss.templates","Discuss.Utils.Localization.LocalizeFilter"]).directive("discussHeader",["$log","DISCUSS_HEADER","DISCUSS_ROOT_PATH",function(t,e,s){"use strict";var i={restrict:"EA",scope:{showDiscussionToggle:"=?",showCommentToggle:"=?"},templateUrl:s+"/components/header/discuss-header.html",link:function(s){var i,n="discussHeader";i=function(e,i){s.$emit(e,i),t.debug("Event emitted: "+e+", Source: "+n)},s.isVisible=!0,s.showDiscussionToggle=s.showDiscussionToggle||!1,s.showCommentToggle=s.showCommentToggle||!1,s.showVisibleDiscussions=function(){s.isVisible=!0,i(e.EVENTS.DISCUSSION.SHOW_VISIBLE)},s.showHiddenDiscussions=function(){s.isVisible=!1,i(e.EVENTS.DISCUSSION.SHOW_HIDDEN)},s.showVisibleComments=function(){s.isVisible=!0,i(e.EVENTS.COMMENT.SHOW_VISIBLE)},s.showHiddenComments=function(){s.isVisible=!1,i(e.EVENTS.COMMENT.SHOW_HIDDEN)},s.$on("discussion.thread-view.showHiddenComments",function(){s.isVisible=!1,t.debug("Event captured: discussion.thread-view.showHiddenComments, Source: discussHeader")}),s.$on("discussion.list-view.showHiddenDiscussions",function(){s.isVisible=!1,t.debug("Event captured: discussion.list-view.showHiddenDiscussions, Source: discussHeader")})}};return i}]),angular.module("Discuss.Header.Event",[]).constant("DISCUSS_HEADER",{EVENTS:{DISCUSSION:{SHOW_VISIBLE:"discussion.discussHeader.showVisibleDiscussions",SHOW_HIDDEN:"discussion.discussHeader.showHiddenDiscussions"},COMMENT:{SHOW_VISIBLE:"discussion.discussHeader.showVisibleComments",SHOW_HIDDEN:"discussion.discussHeader.showHiddenComments"}}}),angular.module("Discuss.MoreOrLess",["Discuss.paths","Discuss.templates","Discuss.Utils.Localization.LocalizeFilter"]).directive("discussMoreOrLess",["$log","DISCUSS_ROOT_PATH",function(t,e){"use strict";return{restrict:"EA",scope:{numLimit:"=",numTotal:"=",numVisible:"="},templateUrl:e+"/components/more-or-less/more-or-less.html",controller:["$scope",function(t){t.isControlVisible=function(){return t.numTotal>t.numLimit},t.isMoreVisible=function(){return t.numVisible===t.numLimit},t.isLessVisible=function(){return t.numVisible===t.numTotal},t.showMore=function(e){e&&(e.preventDefault(),e.stopPropagation()),t.numVisible=t.numTotal},t.showLess=function(e){e&&(e.preventDefault(),e.stopPropagation()),t.numVisible=t.numLimit}}]}}]),angular.module("Discuss.PostDetail",["Discuss.core.security.permissions","Discuss.EditComment","Discuss.paths","Discuss.templates","Discuss.PostDetail.Svc","ngSanitize"]).directive("postDetail",["$log","DISCUSS_ROOT_PATH","DiscussPermissions","DiscussPostDetailSvc","DiscussRestAPIEndpoints",function(t,e,s,i,n){"use strict";return{restrict:"EA",scope:{post:"=",currentUser:"=",showReplyCount:"@",configs:"=?",visibleMode:"=?",thumbnail:"="},templateUrl:e+"/components/post-detail/post-detail.html",controller:["$scope",function(e){var o=this,r={isRemoveCommentEnabled:!0,isEditCommentEnabled:!0,isHideCommentEnabled:!0,attachmentsEnabled:!1};e.configs=_.defaults(e.configs||{},r),e.visibleMode=angular.isDefined(e.visibleMode)?e.visibleMode:!0,e.selectedParticipantId=null,e.attachmentsEnabled=e.configs.attachmentsEnabled||!1,e.clickPost=function(s){s&&(s.preventDefault(),s.stopPropagation()),e.$emit("post-detail.click",e.post),t.debug("Event emitted: post-detail.click, Source: postDetail")},e.isPostOwner=function(){return e.post&&e.post.author===e.currentUser},e.hasAttachment=function(){return e.post&&!!e.post.attachment&&!_.isEmpty(e.post.attachment)&&!e.post.attachment.isDeleted},e.isHideFeatureOn=function(){return!e.isPostOwner()&&e.configs.isHideCommentEnabled&&s.hasPermission("hide_comment")},e.isDownloadLinkVisible=function(){return e.hasAttachment()&&e.attachmentsEnabled},e.isRemoveLinkVisible=function(){return e.isPostOwner()&&e.configs.isRemoveCommentEnabled&&s.hasPermission("remove_comment")&&e.visibleMode},e.isEditLinkVisible=function(){return e.isPostOwner()&&e.configs.isEditCommentEnabled&&s.hasPermission("edit_comment")&&e.visibleMode},e.isHideLinkVisible=function(){return e.isHideFeatureOn()&&e.visibleMode},e.isUnhideLinkVisible=function(){return e.isHideFeatureOn()&&!e.visibleMode},e.isRemoveAttachmentLinkVisible=function(){return e.isDownloadLinkVisible()&&e.configs.isHideCommentEnabled&&e.visibleMode&&s.hasPermission("hide_comment")&&!e.post.attachment.isDeleted},e.isUndoRemovedAttachmentLinkVisible=function(){return e.post&&!!e.post.attachment&&!_.isEmpty(e.post.attachment)&&!!e.post.attachment.isDeleted},e.removeAttachment=function(){e.attachment=_.extend({},e.post.attachment),e.attachment.isDeleted=!0,e.post.attachment={},o.isRightComment=e.post.id,o.isUpdating=!0,e.$emit("discussion.comment.updatePost",e.post)},e.$on("discussion.comment.postUpdated",function(t,s){t.preventDefault(),o.isRightComment&&s.id&&o.isRightComment===s.id&&o.isUpdating&&n.editPost(e.post.boardId,e.post.id,s).then(function(){e.post.attachment=e.attachment,o.isUpdating=!o.isUpdating})}),e.undoRemovedAttachment=function(){e.attachment.isDeleted=!1,o.isUpdating=!0,e.$emit("discussion.comment.updatePost",e.post)},e.editComment=function(){e.post.showEditForm=!0,e.$emit("discussion.postDetail.editComment",e.post),t.debug("Event emitted: discussion.postDetail.editComment, Source: postDetail")},e.removeComment=function(t){i.removeComment(t).then(o.emitRemoveSuccessfulEvent,o.emitRemoveFailedEvent)},o.emitRemoveSuccessfulEvent=function(t){e.$emit("discussion.postDetail.removeSuccessful",t)},o.emitRemoveFailedEvent=function(t){e.$emit("discussion.postDetail.removeFailed",t)},e.undoRemove=function(t){i.undoRemoveComment(t).then(o.emitUndoRemoveSuccessfulEvent,o.emitUndoRemoveFailedEvent)},o.emitUndoRemoveSuccessfulEvent=function(t){e.$emit("postDetail.undoRemoveSuccessful",t)},o.emitUndoRemoveFailedEvent=function(t){e.$emit("postDetail.undoRemoveFailed",t)},e.hideComment=function(t){i.hideComment(t).then(o.emitHideSuccessfulEvent,o.emitHideFailedEvent)},o.emitHideSuccessfulEvent=function(t){e.$emit("discussion.postDetail.hideSuccessful",t)},o.emitHideFailedEvent=function(t){e.$emit("discussion.postDetail.hideFailed",t)},e.undoHide=function(t){i.undoHideComment(t).then(o.emitUndoHideSuccessfulEvent,o.emitUndoHideFailedEvent)},o.emitUndoHideSuccessfulEvent=function(t){e.$emit("postDetail.undoHideSuccessful",t)},o.emitUndoHideFailedEvent=function(t){e.$emit("postDetail.undoHideFailed",t)},e.$on("discussion.editComment.cancel",function(){t.debug("Event captured: discussion.editComment.cancel, Source: postDetail"),o.hideEditCommentForm()}),o.hideEditCommentForm=function(){e.$broadcast("discussion.editComment.enableUpdateSpinner",!1),e.post.showEditForm=!1},e.$on("postDetail.hideEditCommentForm",function(){o.hideEditCommentForm()}),e.showDefaultComment=function(){return e.post&&!e.post.$isArchived()&&!e.post.$isHidden()&&!e.post.showEditForm||!e.visibleMode&&e.post.hide},e.showUndoRemoveComment=function(){return e.post&&e.post.$isArchived()},e.showUndoHideComment=function(){return e.post&&e.post.$isHidden()&&e.visibleMode},e.hiddenComments=function(){e.$emit("discussion.postDetail.showHiddenComments"),t.debug("Event emitted: discussion.postDetail.showHiddenComments, Source: postDetail")
},e.downloadAttachment=function(){e.$emit("discussion.attachment.file.download",e.post.attachment)},e.$on("discussion.thread-view.highlightParticipantComments.post",function(t,s){e.selectedParticipantId=s})}]}}]),angular.module("Discuss.PostDetail.Svc",["Discuss.RestAPI.Endpoints"]).service("DiscussPostDetailSvc",["DiscussRestAPIEndpoints",function(t){"use strict";var e={};return e.removeComment=function(e){return t.archivePost(e)},e.undoRemoveComment=function(e){return t.unarchivePost(e)},e.hideComment=function(e){return t.hidePost(e)},e.undoHideComment=function(e){return t.unhidePost(e)},e}]),angular.module("Discuss.PostParticipants",["Discuss.paths","Discuss.templates","Discuss.MoreOrLess","Discuss.Utils.Localization.LocalizeFilter"]).directive("postParticipants",["$log","DISCUSS_ROOT_PATH",function(t,e){"use strict";return{restrict:"EA",scope:{participants:"="},templateUrl:e+"/components/post-participants/post-participants.html",controller:["$scope",function(t){t.numLimitParticipants=10,t.numVisibleParticipants=t.numLimitParticipants,t.showNoActiveParticipantsMessage=function(){return t.participants&&0===t.participants.length},t.showActiveParticipantsMessage=function(){return!t.showNoActiveParticipantsMessage()}}]}}]),angular.module("Discuss.PostReply",["Discuss.paths","Discuss.templates","Discuss.Utils.Localization.LocalizeFilter","Discuss.SubmitButton","Discuss.AttachFile"]).directive("postReply",["$log","DiscussRestAPIEndpoints","DISCUSS_ROOT_PATH",function(t,e,s){"use strict";return{restrict:"EA",scope:{post:"=",configs:"=?",position:"@",reply:"=?"},templateUrl:s+"/components/post-reply/post-reply.html",controller:["$scope",function(s){var i,n=this;s.fileAttachSuccess=!1,s.attachmentsEnabled=s.configs.attachmentsEnabled||!1,s.reply.body=s.reply.body||"",s.reply.attachment=s.reply.attachment||{},s.cancel=function(){i={post:s.post,replyPosition:s.position},s.$emit("postReply.cancel",i),t.debug("Event emitted: postReply.cancel, Source: postReply, Position: ",s.position),s.reply.body="",s.reply.attachment={}},s.submit=function(){s.createReplyForm.$valid&&(i={post:s.post,replyPosition:s.position},s.reply.attachment.isDeleted&&(s.reply.attachment={}),s.$emit("postReply.submit",i),t.debug("Event emitted: postReply.submit, Source: postReply, Position: ",s.position),s.attachmentsEnabled?s.$emit("discussion.comment.updatePost",s.reply):s.createReply(s.reply))},s.createReply=function(t){return e.createReply(s.post.boardId,s.post.id,t).then(n.emitSaveSuccessfulEvent,n.emitSaveFailedEvent)},n.emitSaveSuccessfulEvent=function(t){s.$emit("postReply.saveSuccessful",{post:t,replyPosition:s.position,parentTitle:s.post.title})},n.emitSaveFailedEvent=function(t){s.$emit("postReply.saveFailed",t,{replyPosition:s.position})},n.enableSubmitSpinner=function(t){s.isSubmitInProgress=t},s.isSubmitDisabled=function(){return s.createReplyForm.$invalid||!!s.isSubmitInProgress||!s.createReplyForm.$dirty},s.$on("discussion.comment.postUpdated",function(t,e){s.createReply(e)}),s.$on("postReply.enableSubmitSpinner",function(t,e){n.enableSubmitSpinner(e)}),s.$on("attachment.button.triggered",function(t,e){s.$emit("attachment.link.clicked",e)}),s.$on("discussion.attach.file.success",function(t,e){s.createReplyForm.$setDirty(),s.reply.attachment={id:e.id,name:e.name,type:e.type},s.$broadcast("attach.file.success",e)}),s.$on("attachment.file.download",function(t,e){s.$emit("discussion.attachment.file.download",e)}),s.$on("attachment.file.removeAttachment",function(){_.isEmpty(s.reply.body)&&s.createReplyForm.$setPristine(),s.reply.attachment.isDeleted=!0}),s.$on("attachment.file.undoRemovedAttachment",function(){s.createReplyForm.$setDirty(),s.reply.attachment.isDeleted=!1})}]}}]),angular.module("Discuss.PostSummary",["Discuss.PostSummary.Event","Discuss.Post","Discuss.paths","Discuss.templates","Discuss.SharedServices.DataDelegate","Discuss.core.security.permissions"]).directive("postSummary",["$log","DISCUSS_ROOT_PATH",function(t,e){"use strict";return{restrict:"E",scope:{post:"=",visibleMode:"=?"},templateUrl:e+"/components/post-summary/post-summary.html",controller:["$scope","DiscussDataDelegate","DiscussPermissions","POST_SUMMARY","PERMISSIONS",function(e,s,i,n,o){var r,c="postSummary";r=function(s,i){e.$emit(s,i),t.debug("Event emitted: "+s+", Source: "+c)},e.visibleMode=angular.isDefined(e.visibleMode)?e.visibleMode:!0,e.postCount=angular.isDefined(e.post.hideCnt)?e.post.postCnt-e.post.hideCnt:e.post.postCnt,e.isHidePostLinkVisible=function(t){return e.visibleMode&&!t.$isHidden()&&i.hasPermission(o.HIDE_DISCUSSION)},e.isUnhidePostLinkVisible=function(t){return!e.visibleMode&&t.$isHidden()},e.showDefaultState=function(t){return!t.$isHidden()&&!t.isUndo||!e.visibleMode&&t.$isHidden()},e.showUndoState=function(t){return!!t.isUndo},e.hidePost=function(t,e){e&&(e.preventDefault(),e.stopPropagation()),s.hidePost(t,n.EVENTS.HIDE_POST.SUCCESS,n.EVENTS.HIDE_POST.FAIL)},e.unhidePost=function(t,e){e&&(e.preventDefault(),e.stopPropagation()),s.unhidePost(t,n.EVENTS.UNHIDE_POST.SUCCESS,n.EVENTS.UNHIDE_POST.FAIL)},e.openPost=function(t,s){var i=e.showUndoState(t)||!e.visibleMode;s&&(s.preventDefault(),s.stopPropagation()),i||r(n.EVENTS.OPEN_POST,t)},e.showhiddenDiscussion=function(){r(n.EVENTS.SHOW_HIDDEN_DISCUSSION)}}]}}]),angular.module("Discuss.PostSummary.Event",[]).constant("POST_SUMMARY",{EVENTS:{HIDE_POST:{SUCCESS:"discussion.post-summary.hidePostSuccessful",FAIL:"discussion.post-summary.hidePostFailure"},UNHIDE_POST:{SUCCESS:"discussion.post-summary.unhidePostSuccessful",FAIL:"discussion.post-summary.unhidePostFailure"},OPEN_POST:"discussion.post-summary.openPost",SHOW_HIDDEN_DISCUSSION:"discussion.postSummary.showHiddenDiscussions"}}),angular.module("Discuss.ScrollIf",[]).directive("discussScrollIf",["$timeout",function(t){"use strict";return{scope:{scrollCondition:"=discussScrollIf"},link:function(e,s,i){var n,o,r=0;e.$watch("scrollCondition",function(c){c===!0&&t(function(){n=s.prop("offsetTop"),o=angular.element(i.discussScrollContainerId).prop("offsetTop"),angular.element("html,body").animate({scrollTop:n-o},{duration:500,complete:function(){e.$emit("scrollIf.completed")}})},r)})}}}]),angular.module("Discuss.SubmitButton",["Discuss.paths"]).directive("discussSubmitBtn",["DISCUSS_ROOT_PATH",function(t){"use strict";return{restrict:"EA",transclude:!0,templateUrl:t+"/components/submit-button/submit-button.html",scope:{isSubmitDisabled:"=disabledIf",isSubmitInProgress:"=inProgressIf",doSubmit:"=submitHandler"}}}]),angular.module("Discuss.Utils.Localization.Service",["realize-lib.localization.messages-service","realize-lib.localization.localize-filter"]).provider("DiscussLocale",["rlzMessagesProvider",function(t){"use strict";var e,s,i="en";s=function(e){var s=e||i;t.setCurrentLocale(s)},this.init=function(i,n){e=n||"/locale/discussion-ui/messages",t.addLanguageFile(e),s(i)},this.$get=["rlzMessages",function(t){var i=this;return i.loadMessages=function(e){return t.load(e)},i.updateLocale=s,i.getMessagesFileLocation=function(){return e},i.sanitizeMessageCode=function(t){if(!e)throw new Error("Must define messgesFileLocation");if(!t)return"";if(!angular.isString(t))throw new TypeError("Unexpected argument type.");return e+"|"+t},i}]}]),angular.module("Discuss.Utils.Localization",["Discuss.Utils.Localization.Service","Discuss.Utils.Localization.LocalizeFilter","Discuss.Utils.Localization.LocalizeAsArrayFilter"]),angular.module("Discuss.Utils.Localization.LocalizeFilter",["Discuss.Utils.Localization.Service"]).filter("discussLocalize",["DiscussLocale","$filter",function(t,e){"use strict";return function(s,i){return s=t.sanitizeMessageCode(s),e("rlzLocalize")(s,i)}}]),angular.module("Discuss.Utils.Localization.LocalizeAsArrayFilter",["Discuss.Utils.Localization.Service"]).filter("discussLocalizeAsArray",["DiscussLocale","rlzMessages",function(t,e){"use strict";return function(s){return s=t.sanitizeMessageCode(s),e.getMessagesAsArray(s)}}]),angular.module("Discuss.CreateView",["Discuss.RestAPI.Endpoints","Discuss.templates","Discuss.Utils.Localization.LocalizeFilter","JetRichtextEditor","Discuss.SubmitButton"]).directive("discussCreateView",["$log","DiscussRestAPIEndpoints",function(t,e){"use strict";var s={restrict:"EA",scope:{boardId:"=",context:"=",configs:"="},templateUrl:"/discuss/views/create/create.html",controller:["$scope",function(s){var i=this;s.isSaveInProgress=!1,s.discussColors=["alpha","bravo","charlie","delta","echo"],s.selectedColor=s.discussColors[0],s.chooseColor=function(t,e){e.preventDefault(),e.stopPropagation(),s.selectedColor=t},s.goBack=function(){s.$emit("discussion.create-view.goBack"),t.debug("Event emitted: discussion.create-view.goBack, Source: discussCreateView")},s.doCancel=function(){s.$emit("discussion.create-view.cancelButtonClicked"),t.debug("Event emitted: discussion.create-view.cancelButtonClicked, Source: discussCreateView")},s.doSave=function(){if(s.savePressed=!0,s.$emit("discussion.create-view.saveButtonClicked"),t.debug("Event emitted: discussion.create-view.saveButtonClicked, Source: discussCreateView"),s.createPostForm.$valid){var n={title:s.post.title,body:s.post.body,meta:{label:s.selectedColor}};return s.isSaveInProgress=!0,e.getBoardByIdAndCreatePost(s.boardId,n,s.context).then(i.emitSaveSuccessfulEvent,i.emitSaveFailedEvent).finally(function(){s.isSaveInProgress=!1})}},s.isSubmitButtonDisabled=function(){return s.createPostForm.$pristine||s.isSaveInProgress},i.emitSaveSuccessfulEvent=function(e){s.$emit("discussion.create-view.saveSuccessful",e),t.debug("Event emitted: discussion.create-view.saveSuccessful, Source: discussCreateView")},i.emitSaveFailedEvent=function(e){s.$emit("discussion.create-view.saveFailed",e),t.debug("Event emitted: discussion.create-view.saveFailed, Source: discussCreateView")},setTimeout(function(){$("#title").focus()},2e3)}]};return s}]),angular.module("Discuss.ListView",["Discuss.List.Event","Discuss.SharedServices.DataDelegate","Discuss.core.security.permissions","Discuss.PostSummary","Discuss.Header","Discuss.Model","Discuss.Filter","Discuss.Utils.Localization.LocalizeFilter"]).directive("discussListView",["$log","DiscussDataDelegate","DiscussPermissions","DISCUSS_LIST","POST_SUMMARY","DISCUSS_HEADER","PERMISSIONS","DiscussBoard",function(t,e,s,i,n,o,r,c){"use strict";var a={restrict:"EA",scope:{boardId:"="},templateUrl:"/discuss/views/list/list.html",link:function(a){var u,d,l="discussListView",m=function(e,s){a.$emit(e,s),t.debug("Event emitted: "+e+", Source: "+l)},h=function(e,s){a.$broadcast(e,s),t.debug("Event broadcast: "+e+", Source: "+l)};a.board=new c({}),d=function(){return e.getBoard(a.boardId,i.EVENTS.GET_DISCUSSIONS_LIST.SUCCESS,i.EVENTS.GET_DISCUSSIONS_LIST.FAIL,i.EVENTS.GET_DISCUSSIONS_LIST.ZERO_STATE).then(function(t){a.board.$upsertPosts(t.posts)})},a.changeMode=function(t){var e=a.visibleMode;("visible"===t||"hidden"===t)&&(a.visibleMode="visible"===t,e!==a.visibleMode&&a.board.$removeIsUndoStateFromPosts())},u=function(){d(),a.changeMode("visible")},u(),a.hasCreateDiscussionPermission=s.hasPermission(r.CREATE_DISCUSSION),a.showBoardIsEmptyState=function(){return!a.board.$hasPost()},a.showAllPostsHiddenState=function(){return a.visibleMode&&a.postsFilteredByVisibilityMode&&0===a.postsFilteredByVisibilityMode.length&&a.board.$hasPost()},a.showDefaultState=function(){return!a.showAllPostsHiddenState()&&!a.showBoardIsEmptyState()},a.goBack=function(){m(i.EVENTS.GO_BACK)},a.create=function(){m(i.EVENTS.OPEN_CREATE)},a.$on(n.EVENTS.OPEN_POST,function(t,e){m(i.EVENTS.OPEN_DISCUSSION,e)}),a.$on(o.EVENTS.DISCUSSION.SHOW_VISIBLE,function(){t.debug("Event captured: "+o.EVENTS.DISCUSSION.SHOW_VISIBLE+", Source: discussListView"),a.changeMode("visible")}),a.$on(o.EVENTS.DISCUSSION.SHOW_HIDDEN,function(){t.debug("Event captured: "+o.EVENTS.DISCUSSION.SHOW_HIDDEN+", Source: discussListView"),a.changeMode("hidden")}),a.$on(n.EVENTS.SHOW_HIDDEN_DISCUSSION,function(){a.changeMode("hidden"),t.debug("Event captured: "+n.EVENTS.SHOW_HIDDEN_DISCUSSION+", Source: discussListView"),h(i.EVENTS.SHOW_HIDDEN_DISCUSSION)}),a.$on(n.EVENTS.HIDE_POST.SUCCESS,function(t,e){d().finally(function(){m(i.EVENTS.HIDE_POST.SUCCESS,e)})}),a.$on(n.EVENTS.UNHIDE_POST.SUCCESS,function(t,e){d().finally(function(){0===a.board.$getHiddenPosts().length&&a.changeMode("visible"),m(i.EVENTS.UNHIDE_POST.SUCCESS,e)})})}};return a}]),angular.module("Discuss.List.Event",[]).constant("DISCUSS_LIST",{EVENTS:{OPEN_DISCUSSION:"discussion.list-view.postClick",OPEN_CREATE:"discussion.list-view.createClick",GO_BACK:"discussion.list-view.goBack",GET_DISCUSSIONS_LIST:{ZERO_STATE:"discussion.list-view.zeroState",SUCCESS:"discussion.list-view.success",FAIL:"discussion.list-view.notFound"},HIDE_POST:{SUCCESS:"discussion.list-view.hidePostSuccessful"},UNHIDE_POST:{SUCCESS:"discussion.list-view.unhidePostSuccessful"},SHOW_HIDDEN_DISCUSSION:"discussion.list-view.showHiddenDiscussions"}}),angular.module("Discuss.ThreadView",["Discuss.Thread","Discuss.ThreadView.Svc","Discuss.RestAPI.Endpoints","Discuss.Header","Discuss.Model","Discuss.PostDetail","Discuss.PostReply","Discuss.PostParticipants","Discuss.Utils.Localization.LocalizeFilter","Discuss.Filter","ngSanitize","Discuss.core.security.permissions"]).directive("discussThreadView",["$log","DiscussRestAPIEndpoints","DiscussThread","$timeout","DiscussThreadViewSvc","DiscussPermissions","DiscussThumbnailCustomizations",function(t,e,s,i,n,o,r){"use strict";var c={restrict:"EA",scope:{boardId:"=",postId:"=",configs:"=?",currentUser:"="},templateUrl:"/discuss/views/thread/thread.html",controller:["$scope",function(c){var a=this,u=[],d=[];t.debug("create_discussion",o.hasPermission("create_discussion")),c.thread=new s({}),c.currentPostCount={},c.selectedParticipantId=null,c.configs=c.configs||{},c.isReviewMode=function(){return c.configs&&c.configs.mode&&"review"===c.configs.mode},c.discussionAuthorId=null,c.replyConfigs={currentUser:c.currentUser,attachmentsEnabled:c.configs.attachmentsEnabled},c.promptConfigs={currentUser:c.currentUser,attachmentsEnabled:c.configs.attachmentsEnabled,isRemoveCommentEnabled:!1,isHideCommentEnabled:!1},c.promptConfigs.isEditCommentEnabled=c.configs.promptConfig?c.configs.promptConfig.isEditCommentEnabled:!0,c.isTopReplyFormVisible=!1,c.isBottomReplyFormVisible=!1,c.isReviewMode()&&(c.promptConfigs.isEditCommentEnabled=!1,c.replyConfigs={isEditCommentEnabled:!1},c.replyConfigs.isRemoveCommentEnabled=c.configs.replyConfigs?c.configs.replyConfigs.isRemoveCommentEnabled:null),c.reply={body:"",attachment:{}},c.getCurrentPostCount=function(){return c.thread.childPostCollection.$getCurrentPostsCount()},c.changeMode=function(t){("visible"===t||"hidden"===t)&&(c.visibleMode="visible"===t,c.mode=t,c.thread.childPostCollection.$removeIsUndoStateFromPosts())},c.changeMode("visible"),c.showReply=function(){var t=c.reply;a.showReplyForm("top"),a.hideReplyForm("bottom"),c.reply=t,i(function(){$("#top-message").focus()},0)},c.showReplyOnBottom=function(){var t=c.reply;a.showReplyForm("bottom"),a.hideReplyForm("top"),c.reply=t,i(function(){$("#bottom-message").focus()},0)},a.showReplyForm=function(t){a.hideEditForm(),l(t,!0)},a.hideReplyForm=function(t){l(t,!1),c.reply={body:"",attachment:{}},c.$broadcast("postReply.enableSubmitSpinner",!1)};var l=function(t,e){if("top"===t)c.isTopReplyFormVisible=e;else{if("bottom"!==t)throw new Error("Invalid position: ",t);c.isBottomReplyFormVisible=e}};a.toggleEditPromptForm=function(){c.thread.childPostCollection.$forEach(function(t){t.showEditForm=!1})},a.hideEditForm=function(){c.thread.topPost.showEditForm=!1,a.toggleEditPromptForm()},c.goBack=function(){c.$emit("discussion.thread-view.goBack"),t.debug("Event emitted: discussion.thread-view.goBack, Source: discussThreadView")},c.getParticipants=function(){var t=c.thread.childPostCollection.$getParticipants(c.visibleMode),e=_.filter(c.thread.childPostCollection.getVisiblePostParticipantsId(),function(t){return t!==c.discussionAuthorId});return n.hasArrayChanged(u,t)&&(u=t),n.hasArrayChanged(d,e)&&(d=e),u},e.getPost(c.boardId,c.postId).then(function(e){e&&r.getThumbnailForPost(e).then(function(i){c.thread=new s(e,i),c.$emit("discussion.thread-view.getPostCall.success.emit",e),t.debug("Event emitted: discussion.thread-view.getPostCall.success.emit, Source: discussThreadView")})},function(e){t.debug("Error: DiscussRestAPIEndpoints.getPost promise rejected",e)}),c.$on("discussion.thread-view.postAttachmentsLoaded",function(t,e){_.each(c.thread.childPostCollection.posts,function(t){t.attachment=e[t.id]?e[t.id]:t.attachment||{}})}),c.$on("postReply.cancel",function(e,s){a.hideReplyForm(s.replyPosition),t.debug("Event captured: postReply.cancel, Source: discussThreadView, Position: ",s.replyPosition)}),c.$on("postReply.submit",function(e,s){c.$broadcast("postReply.enableSubmitSpinner",!0),t.debug("Event captured: postReply.submit, Source: discussThreadView, Position: ",s.replyPosition)}),c.$on("discussion.postDetail.editComment",function(e,s){c.$broadcast("discussion.editComment.edit",s.id),a.hideReplyForm("top"),a.hideReplyForm("bottom"),null!==s.parentId&&s.id===c.thread.childPostCollection.posts[0].id&&(c.scrollTargetId=s.id),t.debug("Event captured: discussion.postDetail.editComment, Source: discussThreadView")}),c.$on("postReply.saveSuccessful",function(e,s){n.refreshThread(c.thread).finally(function(){c.thread.childPostCollection.$addPost(s.post),a.hideReplyForm(s.replyPosition),c.$emit("discussion.thread-view.getPostCall.success.emit",c.thread.childPostCollection),"bottom"===s.replyPosition&&(c.scrollTargetId=s.post.id),c.$emit("discussion.thread-view.postReplySuccessful",s),t.debug("Event emitted: discussion.thread-view.postReplySuccessful, Source: discussThreadView")})}),c.$on("postReply.saveFailed",function(e,s,i){n.refreshThread(c.thread).finally(function(){a.hideReplyForm(i.replyPosition),c.$emit("discussion.thread-view.postReplyFailed",s),t.debug("Event emitted: discussion.thread-view.postReplyFailed, Source: discussThreadView")})}),c.$on("discussion.editComment.submit",function(){c.$broadcast("discussion.editComment.enableUpdateSpinner",!0)}),c.$on("discussion.editComment.updateSuccessful",function(e,s){var i=function(){c.scrollTargetId=s.id,c.$broadcast("postDetail.hideEditCommentForm"),c.$emit("discussion.thread-view.updateSuccessful",s)};n.refreshThread(c.thread).finally(function(){c.thread.$updateByTargetPost(s),c.$emit("discussion.thread-view.getPostCall.success.emit",c.thread.childPostCollection),i(),t.debug("Event emitted: discussion.thread-view.updateSuccessful, Source: discussThreadView")})}),c.$on("discussion.editComment.updateFailed",function(e,s){n.refreshThread(c.thread).finally(function(){c.$broadcast("postDetail.hideEditCommentForm"),c.$emit("discussion.thread-view.updateFailed",s),t.debug("Event emitted: discussion.thread-view.updateFailed, Source: discussThreadView")})}),c.$on("discussion.postDetail.removeSuccessful",function(e,s){c.thread.childPostCollection.$archivePost(s),c.scrollTargetId=s.id,n.refreshThread(c.thread).finally(function(){c.$emit("discussion.thread-view.removeReplySuccessful",s),t.debug("Event emitted: discussion.thread-view.removeReplySuccessful, Source: discussThreadView")})}),c.$on("discussion.postDetail.removeFailed",function(e,s){n.refreshThread(c.thread).finally(function(){c.$emit("discussion.thread-view.removeReplyFailed",s),t.debug("Event emitted: discussion.thread-view.removeReplyFailed, Source: discussThreadView")})}),c.$on("postDetail.undoRemoveSuccessful",function(e,s){n.refreshThread(c.thread).finally(function(){c.thread.childPostCollection.$unarchivePost(s),c.scrollTargetId=s.id,c.$emit("discussion.thread-view.undoReplySuccessful",s),t.debug("Event emitted: discussion.thread-view.undoReplySuccessful, Source: discussThreadView")})}),c.$on("postDetail.undoRemoveFailed",function(e,s){n.refreshThread(c.thread).finally(function(){c.$emit("discussion.thread-view.undoReplyFailed",s),t.debug("Event emitted: discussion.thread-view.undoReplyFailed, Source: discussThreadView")})}),c.$on("discussion.postDetail.hideSuccessful",function(e,s){c.thread.childPostCollection.$hidePost(s),c.scrollTargetId=s.id,n.refreshThread(c.thread).finally(function(){c.$emit("discussion.thread-view.hideReplySuccessful",s),t.debug("Event emitted: discussion.thread-view.hideReplySuccessful, Source: discussThreadView")})}),c.$on("discussion.postDetail.hideFailed",function(e,s){n.refreshThread(c.thread).finally(function(){c.$emit("discussion.thread-view.hideReplyFailed",s),t.debug("Event emitted: discussion.thread-view.hideReplyFailed, Source: discussThreadView")})}),c.$on("postDetail.undoHideSuccessful",function(e,s){c.thread.childPostCollection.$unhidePost(s),c.scrollTargetId=s.id,n.refreshThread(c.thread).finally(function(){0===c.thread.topPost.hideCnt&&c.changeMode("visible"),c.$emit("discussion.thread-view.unhideReplySuccessful",s),t.debug("Event emitted: discussion.thread-view.unhideReplySuccessful, Source: discussThreadView")})}),c.$on("postDetail.undoHideFailed",function(e,s){n.refreshThread(c.thread).finally(function(){c.$emit("discussion.thread-view.unhideReplyFailed",s),t.debug("Event emitted: discussion.thread-view.unhideReplyFailed, Source: discussThreadView")})}),c.$on("discussion.postDetail.showHiddenComments",function(){c.changeMode("hidden"),c.$broadcast("discussion.thread-view.showHiddenComments"),t.debug("Event broadcast: discussion.thread-view.showHiddenComments, Source: discussThreadView")}),c.$on("scrollIf.completed",function(t){t.stopPropagation(),c.scrollTargetId=""}),c.$on("discussion.discussHeader.showVisibleComments",function(){c.changeMode("visible")}),c.$on("discussion.discussHeader.showHiddenComments",function(){c.changeMode("hidden")}),c.$on("discussion.thread-view.highlightParticipantComments",function(t,e,s){c.discussionAuthorId=s,c.$emit("discussion.thread-view.highlightParticipantComments.success",d),c.selectedParticipantId=d.length?e:null}),c.$watch("thread.topPost.hideCnt",function(){c.$emit("discussion.thread-view.showCommentToggle",c.thread.topPost.hideCnt>0)}),c.$on("attachment.link.clicked",function(e,s){t.log("args.type",s.type);var i="discussion.attach."+s.type;c.$emit(i)}),c.$on("attach.file.success",function(t,e){c.$broadcast("discussion.attach.file.success",e)}),c.$on("$destroy",function(){delete c.thread.childPostCollection})}]};return c}]),angular.module("Discuss.ThreadView.Svc",["Discuss.RestAPI.Endpoints"]).service("DiscussThreadViewSvc",["DiscussRestAPIEndpoints",function(t){"use strict";var e={};return e.refreshThread=function(e){return t.getPost(e.topPost.boardId,e.topPost.id).then(function(t){return e.$copy(t),e},function(){return e})},e.hasArrayChanged=function(t,e){return!angular.equals(t.sort(),e.sort())},e}]);
//# sourceMappingURL=discussion-service.scripts.min.js.map